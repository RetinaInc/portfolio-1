var app=angular.module("ng-portfolio",["ui.router","ui.bootstrap","ngTable","hc.marked","ngTagsInput"]);app.config(function($httpProvider){$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"});app.config(function(tagsInputConfigProvider){tagsInputConfigProvider.setDefaults("tagsInput",{replaceSpacesWithDashes:false})});app.config(["markedProvider",function(markedProvider){markedProvider.setOptions({gfm:true,tables:true})}]);app.config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/dashboard");$stateProvider.state("dashboard",{url:"/dashboard",templateUrl:"/vendor/portfolio/admin/views/dashboard.html",controller:"DashboardController"}).state("project",{url:"/project",templateUrl:"/vendor/portfolio/admin/views/project/project.html"}).state("project.index",{url:"/index",templateUrl:"/vendor/portfolio/admin/views/project/project.index.html",controller:"ProjectController"}).state("project.create",{url:"/create",templateUrl:"/vendor/portfolio/admin/views/project/project.edit.html",controller:"ProjectCreateController"}).state("project.edit",{url:"/:id/edit",templateUrl:"/vendor/portfolio/admin/views/project/project.edit.html",controller:"ProjectEditController"}).state("project-section",{url:"/project/:id/section",templateUrl:"/vendor/portfolio/admin/views/project/project.section.index.html",controller:"ProjectSectionController"}).state("section-edit",{url:"/section/:id/edit",templateUrl:"/vendor/portfolio/admin/views/section/section.edit.html",controller:"SectionEditController"}).state("tag",{url:"/tag",templateUrl:"/vendor/portfolio/admin/views/tag/tag.html"}).state("tag.index",{url:"/index",templateUrl:"/vendor/portfolio/admin/views/tag/tag.index.html",controller:"TagController"}).state("tag.create",{url:"/create",templateUrl:"/vendor/portfolio/admin/views/tag/tag.edit.html",controller:"TagCreateController"}).state("tag.edit",{url:"/:id/edit",templateUrl:"/vendor/portfolio/admin/views/tag/tag.edit.html",controller:"TagEditController"})});app.factory("RestfulApi",function($http,notificationService){var checkResponseCode=function(data,status){switch(status){case 422:notificationService.clear();var msg=[];angular.forEach(data,function(value,key){msg=msg.concat(value)});notificationService.add("Validation failed, please correct the following issues:","danger",msg);break;case 401:notificationService.add("You have been logged out","warning");break;case 500:notificationService.add("API error","danger");break;default:console.log("Some other problem!");console.log(data)}};return{getRoute:function(resource,method,id){if(typeof id==="undefined"){id="0"}var prefix="/admin/api";var routes={project:{index:prefix+"/project",show:prefix+"/project/"+id,store:prefix+"/project",update:prefix+"/project/"+id,destroy:prefix+"/project/"+id},section:{index:prefix+"/section",show:prefix+"/section/"+id,store:prefix+"/section",update:prefix+"/section/"+id,destroy:prefix+"/section/"+id},projectSection:{store:prefix+"/project/"+id+"/section"},tag:{index:prefix+"/tag",show:prefix+"/tag/"+id,store:prefix+"/tag",update:prefix+"/tag/"+id,destroy:prefix+"/tag/"+id}};return routes[resource][method]},success:function(data,status,headers,config){notificationService.removeByType("danger");return data},error:function(data,status,headers,config){checkResponseCode(data,status);return data}}});app.service("notificationService",function($timeout){var notifications=[];this.get=function(){return notifications};this.add=function(message,type,messages){if(type=="success"){this.removeByType("success")}var notification={type:type,message:message,messages:messages};notifications.push(notification);console.log("added "+type+" message");if(type!="danger"){$timeout(function(){notifications.splice(notifications.indexOf(notification),1)},6e3)}};this.removeByIndex=function(index){console.log("removing one message: "+index);notifications.splice(index,1)};this.removeByType=function(type){console.log("clearing "+type+" messages");for(i=0;i<notifications.length;i++){if(notifications[i].type==type){notifications.splice(i,1)}}};this.clear=function(){console.log("clearing all messages");notifications=[]}});app.controller("NotificationController",function($scope,notificationService,$timeout){$scope.notifier=notificationService;$scope.$watch("notifier.get()",function(notifications){if(angular.isDefined(notifications)){$scope.notifications=notifications}},true);$scope.closeNotification=function(index){notificationService.removeByIndex(index)}});app.controller("DashboardController",function($scope,$http,$stateParams){});app.controller("ProjectController",function($scope,$filter,ngTableParams,$http,RestfulApi,notificationService){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){$http.get(RestfulApi.getRoute("project","index")).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config)})};$scope.delete=function(id,title){if(confirm("Are you sure you wish to delete "+title+"?")){$http.delete("/admin/api/project/"+id).success(function(data,status,headers,config){notificationService.add("Project '"+data.title+"' deleted successfully","info");$scope.init()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.init()});app.controller("ProjectCreateController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService){$scope.data={};$scope.create=true;$scope.save=function(apply){$http.post(RestfulApi.getRoute("project","store"),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Project '"+data.title+"' added successfully","success");$scope.errors=[];if(!apply){$state.go("project.index")}else{$state.go("project.edit",{id:data.id})}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("ProjectEditController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService,ngTableParams,$filter,$modal){$scope.data={sections:[]};$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.sections.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data.sections,params.filter()):$scope.data.sections;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data.sections;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$http.get(RestfulApi.getRoute("project","show",$stateParams.id)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.slug=$scope.data.slug;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data});$scope.editSection=function(create,sectionId){sectionId=typeof sectionId!=="undefined"?sectionId:false;modalData={create:create,projectId:$scope.data.id,sectionId:sectionId};console.log(modalData);var modalInstance=$modal.open({animation:true,templateUrl:"sectionEdit.html",controller:"editSectionController",size:"lg",resolve:{modalData:function(){return modalData}}});modalInstance.result.then(function(section,create){if(create){$scope.data.sections.push(section)}else{angular.forEach($scope.data.sections,function(value,key){if(value.id==sectionId){$scope.data.sections[value.id]=section}})}$scope.tableParams.reload()},function(){})};$scope.slugWarning=function(){notificationService.removeByType("warning");if($scope.slug!=$scope.data.slug){notificationService.add("You have modified the project slug. Please be aware that this may break hyperlinks to this project.","warning")}};$scope.save=function(apply){apply=typeof apply!=="undefined"?apply:false;if($scope.slug!=$scope.data.slug){if(confirm("Are you sure you wish to change the slug?")){$scope.put(apply)}else{$scope.data.slug=$scope.slug;notificationService.removeByType("warning");notificationService.add("Slug reset","info")}}else{$scope.put(apply)}};$scope.put=function(apply){$http.put(RestfulApi.getRoute("project","update",$stateParams.id),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Project '"+data.title+"' updated successfully","success");$scope.errors=[];if(!apply){$state.go("project.index")}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("editSectionController",function($scope,$http,$modalInstance,RestfulApi,notificationService,modalData){if(!modalData.create){$http.get(RestfulApi.getRoute("section","show",modalData.sectionId)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.section=data}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}$scope.save=function(){console.log(modalData.projectId);if(modalData.create){$http.post(RestfulApi.getRoute("projectSection","store",modalData.projectId),$scope.section).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Section '"+data.title+"' created successfully","success");$scope.errors=[];$modalInstance.close(data,true)}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}else{$http.put(RestfulApi.getRoute("section","update",$scope.section.id),$scope.section).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Section '"+data.title+"' updated successfully","success");$scope.errors=[];$modalInstance.close(data,false)}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.cancel=function(){$modalInstance.dismiss("cancel")}});app.controller("ProjectSectionController",function($scope,$filter,ngTableParams,$http,$route,$routeParams,$location){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{created_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){console.log($routeParams.project_id);$http.get("/admin/api/project/"+$routeParams.project_id+"/section").success(function(data,status,headers,config){$scope.data=data;angular.forEach(data,function(data){data.id=parseFloat(data.id)});$scope.tableParams.reload()}).error(function(data,status,headers,config){console.log(status);if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})};$scope.delete=function(id){$http.delete("/admin/api/project/"+id).success(function(data,status,headers,config){$scope.init()}).error(function(data,status,headers,config){$scope.errors=data})};$scope.init()});app.controller("SectionCreateController",function($scope,$http,$route,$routeParams,$location){$scope.data={};$scope.save=function(){$http.post("/admin/api/project",$scope.data).success(function(data,status,headers,config){$location.path("/project")}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})}});app.controller("SectionEditController",function($scope,$http,$route,$routeParams,$location){$scope.data={};$http.get("/admin/api/section/"+$routeParams.id).success(function(data,status,headers,config){$scope.data=data}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}});$scope.addSection=function(){$scope.data.sections.push({})};$scope.deleteSection=function(index){$scope.data.sections.splice(index,1)};$scope.save=function(){$http.put("/admin/api/section/"+$routeParams.id,$scope.data).success(function(data,status,headers,config){$location.path("/project/"+data.attachment_id+"/section")}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})}});app.controller("TagController",function($scope,$filter,ngTableParams,$http,RestfulApi,notificationService){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){$http.get(RestfulApi.getRoute("tag","index")).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config)})};$scope.delete=function(id,title){if(confirm("Are you sure you wish to delete "+title+"?")){$http.delete(RestfulApi.getRoute("tag","destroy",id)).success(function(data,status,headers,config){notificationService.add("Project '"+data.title+"' deleted successfully","info");$scope.init()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.init()});app.controller("TagCreateController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService){$scope.data={};$scope.create=true;$scope.save=function(apply){$http.post(RestfulApi.getRoute("tag","store"),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Tag '"+data.title+"' added successfully","success");$scope.errors=[];if(!apply){$state.go("tag.index")}else{$state.go("tag.edit",{id:data.id})}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("TagEditController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService,ngTableParams,$filter,$modal){$scope.data={};$http.get(RestfulApi.getRoute("tag","show",$stateParams.id)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data});$scope.save=function(apply){apply=typeof apply!=="undefined"?apply:false;$scope.put(apply)};$scope.put=function(apply){$http.put(RestfulApi.getRoute("tag","update",$stateParams.id),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Tag '"+data.title+"' updated successfully","success");$scope.errors=[];if(!apply){$state.go("tag.index")}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9wdWJsaWMvYWRtaW4vanMvbWFpbi5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInRhZ3NJbnB1dENvbmZpZ1Byb3ZpZGVyIiwic2V0RGVmYXVsdHMiLCJyZXBsYWNlU3BhY2VzV2l0aERhc2hlcyIsIm1hcmtlZFByb3ZpZGVyIiwic2V0T3B0aW9ucyIsImdmbSIsInRhYmxlcyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJmYWN0b3J5IiwiJGh0dHAiLCJub3RpZmljYXRpb25TZXJ2aWNlIiwiY2hlY2tSZXNwb25zZUNvZGUiLCJkYXRhIiwic3RhdHVzIiwiY2xlYXIiLCJtc2ciLCJmb3JFYWNoIiwidmFsdWUiLCJrZXkiLCJjb25jYXQiLCJhZGQiLCJjb25zb2xlIiwibG9nIiwiZ2V0Um91dGUiLCJyZXNvdXJjZSIsIm1ldGhvZCIsImlkIiwicHJlZml4Iiwicm91dGVzIiwicHJvamVjdCIsImluZGV4Iiwic2hvdyIsInN0b3JlIiwidXBkYXRlIiwiZGVzdHJveSIsInNlY3Rpb24iLCJwcm9qZWN0U2VjdGlvbiIsInRhZyIsInN1Y2Nlc3MiLCJyZW1vdmVCeVR5cGUiLCJlcnJvciIsInNlcnZpY2UiLCIkdGltZW91dCIsIm5vdGlmaWNhdGlvbnMiLCJ0aGlzIiwiZ2V0IiwibWVzc2FnZSIsInR5cGUiLCJtZXNzYWdlcyIsIm5vdGlmaWNhdGlvbiIsInB1c2giLCJzcGxpY2UiLCJpbmRleE9mIiwicmVtb3ZlQnlJbmRleCIsImkiLCJsZW5ndGgiLCIkc2NvcGUiLCJub3RpZmllciIsIiR3YXRjaCIsImlzRGVmaW5lZCIsImNsb3NlTm90aWZpY2F0aW9uIiwiJHN0YXRlUGFyYW1zIiwiJGZpbHRlciIsIm5nVGFibGVQYXJhbXMiLCJSZXN0ZnVsQXBpIiwidGFibGVQYXJhbXMiLCJwYWdlIiwiY291bnQiLCJzb3J0aW5nIiwidXBkYXRlZF9hdCIsImZpbHRlckRlbGF5IiwidG90YWwiLCJnZXREYXRhIiwiJGRlZmVyIiwicGFyYW1zIiwiZmlsdGVyZWREYXRhIiwiZmlsdGVyIiwib3JkZXJlZERhdGEiLCJvcmRlckJ5IiwicmVzb2x2ZSIsInNsaWNlIiwiaW5pdCIsInJlbG9hZCIsImRlbGV0ZSIsInRpdGxlIiwiY29uZmlybSIsImVycm9ycyIsIiRzdGF0ZSIsImNyZWF0ZSIsInNhdmUiLCJhcHBseSIsInBvc3QiLCJnbyIsIiRtb2RhbCIsInNlY3Rpb25zIiwic2x1ZyIsImVkaXRTZWN0aW9uIiwic2VjdGlvbklkIiwibW9kYWxEYXRhIiwicHJvamVjdElkIiwibW9kYWxJbnN0YW5jZSIsIm9wZW4iLCJhbmltYXRpb24iLCJzaXplIiwicmVzdWx0IiwidGhlbiIsInNsdWdXYXJuaW5nIiwicHV0IiwiJG1vZGFsSW5zdGFuY2UiLCJjbG9zZSIsImNhbmNlbCIsImRpc21pc3MiLCIkcm91dGUiLCIkcm91dGVQYXJhbXMiLCIkbG9jYXRpb24iLCJjcmVhdGVkX2F0IiwicHJvamVjdF9pZCIsInBhcnNlRmxvYXQiLCJMb2dnZWQgb3V0IiwicGF0aCIsImFkZFNlY3Rpb24iLCJkZWxldGVTZWN0aW9uIiwiYXR0YWNobWVudF9pZCJdLCJtYXBwaW5ncyI6IkFBQ0EsR0FBSUEsS0FBTUMsUUFBUUMsT0FBTyxnQkFBaUIsWUFBYSxlQUFnQixVQUFXLFlBQWEsZUFVL0ZGLEtBQUlHLE9BQU8sU0FBU0MsZUFFaEJBLGNBQWNDLFNBQVNDLFFBQVFDLE9BQU8sb0JBQXNCLGtCQUdoRVAsS0FBSUcsT0FBTyxTQUFTSyx5QkFDbEJBLHdCQUF3QkMsWUFBWSxhQUNsQ0Msd0JBQTBCLFNBTTlCVixLQUFJRyxRQUFRLGlCQUFrQixTQUFTUSxnQkFDbkNBLGVBQWVDLFlBQ1hDLElBQUssS0FDTEMsT0FBUSxTQU1oQmQsS0FBSUcs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QUFRc0MsYUFBYW5DLEtBQ3REWSxRQUFRLFNBQVMxQixLQUFNQyxPQUFRckIsUUFBU0gsUUFDcEMyRSxXQUFXMUIsUUFBUTFCLEtBQU1DLE9BQVFyQixRQUFTSCxPQUMxQ21FLFFBQU81QyxLQUFPQSxPQUVsQjRCLE1BQU0sU0FBUzVCLEtBQU1DLE9BQVFyQixRQUFTSCxRQUNsQzJFLFdBQVd4QixNQUFNNUIsS0FBTUMsT0FBUXJCLFFBQVNILE9BQ3hDbUUsUUFBTzhCLE9BQVMxRSxNQUd4QjRDLFFBQU9pQyxLQUFPLFNBQVNDLE9BQ25CQSxZQUFlQSxTQUFVLFlBQWNBLE1BQVEsS0FDL0NsQyxRQUFPbUQsSUFBSWpCLE9BR2ZsQyxRQUFPbUQsSUFBTSxTQUFTakIsT0FDbEJqRixNQUFNa0csSUFBSTNDLFdBQVd6QyxTQUFTLE1BQU8sU0FBVXNDLGFBQWFuQyxJQUFLOEIsT0FBTzVDLE1BQ3hFMEIsUUFBUSxTQUFTMUIsS0FBTUMsT0FBUXJCLFFBQVNILFFBQ3BDMkUsV0FBVzFCLFFBQVExQixLQUFNQyxPQUFRckIsUUFBU0gsT0FDMUNxQixxQkFBb0JVLElBQUksUUFBVVIsS0FBS3dFLE1BQVEseUJBQTBCLFVBQ3pFNUIsUUFBTzhCLFNBQ1AsS0FBS0ksTUFBTyxDQUNSSCxPQUFPSyxHQUFJLGdCQUduQnBELE1BQU0sU0FBUzVCLEtBQU1DLE9BQVFyQixRQUFTSCxRQUNsQzJFLFdBQVd4QixNQUFNNUIsS0FBTUMsT0FBUXJCLFFBQVNILE9BQ3hDbUUsUUFBTzhCLE9BQVMxRSIsImZpbGUiOiJzcmMvcHVibGljL2FkbWluL2pzL21haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaXJlIHVwIHRoZSBhcHBcbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbmctcG9ydGZvbGlvJywgWyd1aS5yb3V0ZXInLCAndWkuYm9vdHN0cmFwJywgJ25nVGFibGUnLCAnaGMubWFya2VkJywgJ25nVGFnc0lucHV0J10pO1xuXG4vLyBDb25maWd1cmUgQW5ndWxhclxuXG4vKiBhcHAuY29uZmlnKGZ1bmN0aW9uKCRpbnRlcnBvbGF0ZVByb3ZpZGVyKSB7XG4gICAgLy8gU2V0IEFuZ3VsYXIgdG8gdXNlIHNxdWFyZS1icmFja2V0cyBpbnN0ZWFkIG9mIGN1cmx5IC0gYSB3b3JrIGFyb3VuZCB0byBwbGF5IG5pY2Ugd2l0aCBMYXJhdmVsIEJsYWRlIHRlbXBsYXRlc1xuICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLnN0YXJ0U3ltYm9sKCd7eycpO1xuICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLmVuZFN5bWJvbCgnfX0nKTtcbn0pOyAqL1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIpIHtcbiAgICAvLyBBZGQgdGhlIFhNTEh0dHBSZXF1ZXN0IGhlYWRlciBzbyB0aGF0IExhcmF2ZWwgY2FuIHRlbGwgYXBhcnQgQUpBWCByZXF1ZXN0c1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bXCJYLVJlcXVlc3RlZC1XaXRoXCJdID0gXCJYTUxIdHRwUmVxdWVzdFwiO1xufSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24odGFnc0lucHV0Q29uZmlnUHJvdmlkZXIpIHtcbiAgdGFnc0lucHV0Q29uZmlnUHJvdmlkZXIuc2V0RGVmYXVsdHMoJ3RhZ3NJbnB1dCcsIHtcbiAgICByZXBsYWNlU3BhY2VzV2l0aERhc2hlcyA6IGZhbHNlXG4gICAgLy9wbGFjZWhvbGRlcjogJ05ldyB0YWcnLFxuICAgIC8vcmVtb3ZlVGFnU3ltYm9sOiAn4pyWJ1xuICB9KVxufSk7XG5cbmFwcC5jb25maWcoWydtYXJrZWRQcm92aWRlcicsIGZ1bmN0aW9uKG1hcmtlZFByb3ZpZGVyKSB7XG4gICAgbWFya2VkUHJvdmlkZXIuc2V0T3B0aW9ucyh7XG4gICAgICAgIGdmbTogdHJ1ZSxcbiAgICAgICAgdGFibGVzOiB0cnVlXG4gICAgfSk7XG59XSk7XG5cblxuLy8gU2V0dXAgdGhlIHN0YXRlIG1hbmFnZXIgKFJvdXRlcilcbmFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gIC8vIEZvciBhbnkgdW5tYXRjaGVkIHVybCwgcmVkaXJlY3QgdG8gL3N0YXRlMVxuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKFwiL2Rhc2hib2FyZFwiKTtcblxuICAvLyR1cmxSb3V0ZXJQcm92aWRlci53aGVuKCcvcHJvamVjdCcsICcvcHJvamVjdC9pbmRleCcpO1xuXG4gIC8vIE5vdyBzZXQgdXAgdGhlIHN0YXRlc1xuICAkc3RhdGVQcm92aWRlclxuICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuICAgICAgdXJsOiBcIi9kYXNoYm9hcmRcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL2Rhc2hib2FyZC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIkRhc2hib2FyZENvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0Jywge1xuICAgICAgdXJsOiBcIi9wcm9qZWN0XCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9wcm9qZWN0L3Byb2plY3QuaHRtbFwiLFxuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0LmluZGV4Jywge1xuICAgICAgdXJsOiBcIi9pbmRleFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvcHJvamVjdC9wcm9qZWN0LmluZGV4Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiUHJvamVjdENvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0LmNyZWF0ZScsIHtcbiAgICAgIHVybDogXCIvY3JlYXRlXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9wcm9qZWN0L3Byb2plY3QuZWRpdC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlByb2plY3RDcmVhdGVDb250cm9sbGVyXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgncHJvamVjdC5lZGl0Jywge1xuICAgICAgdXJsOiBcIi86aWQvZWRpdFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvcHJvamVjdC9wcm9qZWN0LmVkaXQuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJQcm9qZWN0RWRpdENvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0LXNlY3Rpb24nLCB7XG4gICAgICB1cmw6IFwiL3Byb2plY3QvOmlkL3NlY3Rpb25cIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3Byb2plY3QvcHJvamVjdC5zZWN0aW9uLmluZGV4Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiUHJvamVjdFNlY3Rpb25Db250cm9sbGVyXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgnc2VjdGlvbi1lZGl0Jywge1xuICAgICAgdXJsOiBcIi9zZWN0aW9uLzppZC9lZGl0XCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9zZWN0aW9uL3NlY3Rpb24uZWRpdC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlNlY3Rpb25FZGl0Q29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3RhZycsIHtcbiAgICAgIHVybDogXCIvdGFnXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy90YWcvdGFnLmh0bWxcIixcbiAgICB9KVxuICAgIC5zdGF0ZSgndGFnLmluZGV4Jywge1xuICAgICAgdXJsOiBcIi9pbmRleFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvdGFnL3RhZy5pbmRleC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlRhZ0NvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCd0YWcuY3JlYXRlJywge1xuICAgICAgdXJsOiBcIi9jcmVhdGVcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3RhZy90YWcuZWRpdC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlRhZ0NyZWF0ZUNvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCd0YWcuZWRpdCcsIHtcbiAgICAgIHVybDogXCIvOmlkL2VkaXRcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3RhZy90YWcuZWRpdC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlRhZ0VkaXRDb250cm9sbGVyXCJcbiAgICB9KTtcbn0pO1xuXG5cblxuLy8gU29tZSBoZWxwZnVsIGZ1bmN0aW9ucyBmb3IgQUpBWCByZXF1ZXN0c1xuYXBwLmZhY3RvcnkoJ1Jlc3RmdWxBcGknLCBmdW5jdGlvbiAoJGh0dHAsIG5vdGlmaWNhdGlvblNlcnZpY2UpIHtcblxuICAgIC8vIFdvdCB0byBkbyBpbmNhc2UgQVBJIGZhaWxzIHRvIHJlc3BvbmQgd2l0aCAyMDBcbiAgICB2YXIgY2hlY2tSZXNwb25zZUNvZGUgPSBmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgc3dpdGNoKHN0YXR1cykge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHZhbGlkYXRpb25cbiAgICAgICAgICAgIGNhc2UgNDIyOlxuXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgYWxsIGV4aXN0aW5nIG5vdGlmaWNhdGlvbnNcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmNsZWFyKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDb25jYXRlbmF0ZSBhbGwgdGhlIHZhbGlkYXRpb24gZXJyb3IgbWVzc2FnZXNcbiAgICAgICAgICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgbXNnID0gbXNnLmNvbmNhdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIG5vdGlmaWNhdGlvblxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiVmFsaWRhdGlvbiBmYWlsZWQsIHBsZWFzZSBjb3JyZWN0IHRoZSBmb2xsb3dpbmcgaXNzdWVzOlwiLCAnZGFuZ2VyJywgbXNnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVW5hdXRoZW50aWNhdGVkXG4gICAgICAgICAgICBjYXNlIDQwMTpcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZCgnWW91IGhhdmUgYmVlbiBsb2dnZWQgb3V0JywgJ3dhcm5pbmcnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNTAwOlxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKCdBUEkgZXJyb3InLCAnZGFuZ2VyJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU29tZSBvdGhlciBwcm9ibGVtIVwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgLy8gUmV0dXJucyB0aGUgc3RyaW5nIG9mIGEgcGFydGljdWxhciByb3V0ZVxuICAgICAgICBnZXRSb3V0ZTogZnVuY3Rpb24ocmVzb3VyY2UsIG1ldGhvZCwgaWQpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaWQgPT09ICd1bmRlZmluZWQnKSB7IGlkID0gJzAnOyB9XG5cbiAgICAgICAgICAgIHZhciBwcmVmaXggPSAnL2FkbWluL2FwaSc7XG5cbiAgICAgICAgICAgIHZhciByb3V0ZXMgPSB7XG4gICAgICAgICAgICAgICAgcHJvamVjdCAgICAgOiAge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCAgIDogcHJlZml4ICsgJy9wcm9qZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgc2hvdyAgICA6IHByZWZpeCArICcvcHJvamVjdC8nICsgaWQsXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlICAgOiBwcmVmaXggKyAnL3Byb2plY3QnLFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUgIDogcHJlZml4ICsgJy9wcm9qZWN0LycgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgZGVzdHJveSA6IHByZWZpeCArICcvcHJvamVjdC8nICsgaWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNlY3Rpb24gICAgIDogIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggICA6IHByZWZpeCArICcvc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgIHNob3cgICAgOiBwcmVmaXggKyAnL3NlY3Rpb24vJyArIGlkLFxuICAgICAgICAgICAgICAgICAgICBzdG9yZSAgIDogcHJlZml4ICsgJy9zZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlICA6IHByZWZpeCArICcvc2VjdGlvbi8nICsgaWQsXG4gICAgICAgICAgICAgICAgICAgIGRlc3Ryb3kgOiBwcmVmaXggKyAnL3NlY3Rpb24vJyArIGlkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwcm9qZWN0U2VjdGlvbiAgICAgOiAge1xuICAgICAgICAgICAgICAgICAgICBzdG9yZSAgIDogcHJlZml4ICsgJy9wcm9qZWN0LycgKyBpZCArICcvc2VjdGlvbidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRhZyAgICAgICAgIDogIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggICA6IHByZWZpeCArICcvdGFnJyxcbiAgICAgICAgICAgICAgICAgICAgc2hvdyAgICA6IHByZWZpeCArICcvdGFnLycgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgc3RvcmUgICA6IHByZWZpeCArICcvdGFnJyxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlICA6IHByZWZpeCArICcvdGFnLycgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgZGVzdHJveSA6IHByZWZpeCArICcvdGFnLycgKyBpZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiByb3V0ZXNbcmVzb3VyY2VdW21ldGhvZF07XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvLyBEbyBzb21lIHN0dWZmIHVwb24gYSBzdWNjZXNzZnVsIEFqYXggcmVxdWVzdFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5yZW1vdmVCeVR5cGUoJ2RhbmdlcicpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIERvIHNvbWUgc3R1ZmYgdXBvbiBhbiB1bnN1Y2Nlc3NmdWwgQWpheCByZXF1ZXN0XG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgY2hlY2tSZXNwb25zZUNvZGUoZGF0YSwgc3RhdHVzKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cblxuYXBwLnNlcnZpY2UoJ25vdGlmaWNhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoJHRpbWVvdXQpIHtcblxuICAgIHZhciBub3RpZmljYXRpb25zID0gW107XG5cbiAgICAvLyBSZXRyaWV2ZSBhbGwgbWVzc2FnZXNcbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbm90aWZpY2F0aW9ucztcbiAgICB9O1xuXG4gICAgLy8gUmVtb3ZlIG5ldyBub3RpZmljYXRpb25cbiAgICB0aGlzLmFkZCA9IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUsIG1lc3NhZ2VzKSB7XG5cbiAgICAgICAgLy8gT25seSBhbGxvdyBvbmUgc3VjY2VzcyBtZXNzYWdlIGF0IGEgdGltZVxuICAgICAgICBpZiAodHlwZSA9PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQnlUeXBlKCdzdWNjZXNzJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0ge1xuICAgICAgICAgICAgdHlwZSA6IHR5cGUsXG4gICAgICAgICAgICBtZXNzYWdlIDogbWVzc2FnZSxcbiAgICAgICAgICAgIG1lc3NhZ2VzIDogbWVzc2FnZXMsXG4gICAgICAgICAgICAvL2FjdGlvbiA6IGFjdGlvblxuICAgICAgICB9O1xuXG4gICAgICAgIG5vdGlmaWNhdGlvbnMucHVzaChub3RpZmljYXRpb24pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdhZGRlZCAnICsgdHlwZSArICcgbWVzc2FnZScpO1xuXG4gICAgICAgIGlmICh0eXBlICE9ICdkYW5nZXInKSB7XG4gICAgICAgICAgICAvLyBTZXQgdGhlIGFsZXJ0IHRvIGJlIHJlbW92ZWQgYWZ0ZXIgYSBkZWxheVxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25zLnNwbGljZShub3RpZmljYXRpb25zLmluZGV4T2Yobm90aWZpY2F0aW9uKSwgMSk7XG4gICAgICAgICAgICAgICAgLy8kc2NvcGUuYWxlcnRzLnNwbGljZSgkc2NvcGUuYWxlcnRzLmluZGV4T2YoYWxlcnQpLCAxKTtcbiAgICAgICAgICAgIH0sIDYwMDApOyAvLyBtYXliZSAnfSwgMzAwMCwgZmFsc2UpOycgdG8gYXZvaWQgY2FsbGluZyBhcHBseVxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgLy8gUmVtb3ZlIG5vdGlmaWNhdGlvbiBieSBhcnJheSBpbmRleFxuICAgIHRoaXMucmVtb3ZlQnlJbmRleCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmluZyBvbmUgbWVzc2FnZTogJyArIGluZGV4KTtcbiAgICAgICAgbm90aWZpY2F0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBhbGwgbm90aWZpY2F0aW9ucyBvZiB0eXBlXG4gICAgdGhpcy5yZW1vdmVCeVR5cGUgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGVhcmluZyAnICsgdHlwZSArICcgbWVzc2FnZXMnKTtcbiAgICAgICAgZm9yIChpPTA7IGkgPCBub3RpZmljYXRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uc1tpXS50eXBlID09IHR5cGUpIHtcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25zLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENsZWFyIGFsbCBub3RpZmljYXRpb25zXG4gICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnY2xlYXJpbmcgYWxsIG1lc3NhZ2VzJyk7XG4gICAgICAgIG5vdGlmaWNhdGlvbnMgPSBbXTtcbiAgICB9XG5cbn0pO1xuXG5hcHAuY29udHJvbGxlcignTm90aWZpY2F0aW9uQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgbm90aWZpY2F0aW9uU2VydmljZSwgJHRpbWVvdXQpIHtcblxuICAgICRzY29wZS5ub3RpZmllciA9IG5vdGlmaWNhdGlvblNlcnZpY2U7XG5cblxuICAgICRzY29wZS4kd2F0Y2goJ25vdGlmaWVyLmdldCgpJywgZnVuY3Rpb24gKG5vdGlmaWNhdGlvbnMpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKG5vdGlmaWNhdGlvbnMpKSB7XG4gICAgICAgICAgICAkc2NvcGUubm90aWZpY2F0aW9ucyA9IG5vdGlmaWNhdGlvbnM7XG4gICAgICAgIH1cbiAgICB9LCB0cnVlKTtcblxuXG4gICAgJHNjb3BlLmNsb3NlTm90aWZpY2F0aW9uID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5yZW1vdmVCeUluZGV4KGluZGV4KTtcbiAgICB9O1xuXG5cbn0pO1xuXG5hcHAuY29udHJvbGxlcignRGFzaGJvYXJkQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcykge1xuXG5cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdQcm9qZWN0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGZpbHRlciwgbmdUYWJsZVBhcmFtcywgJGh0dHAsIFJlc3RmdWxBcGksIG5vdGlmaWNhdGlvblNlcnZpY2UpIHtcblxuICAgIC8vIEluaXRpYWxpc2UgYW4gZW1wdHkgYXJyYXkgdG8gaG9sZCBkYXRhXG4gICAgJHNjb3BlLmRhdGEgPSBbXTtcblxuICAgIC8vIEluaXRpYWxpc2UgdGhlIGRhdGEgdGFibGVcbiAgICAkc2NvcGUudGFibGVQYXJhbXMgPSBuZXcgbmdUYWJsZVBhcmFtcyh7XG4gICAgICAgIHBhZ2U6IDEsICAgICAgICAgICAgLy8gc2hvdyBmaXJzdCBwYWdlXG4gICAgICAgIGNvdW50OiAxMCwgICAgICAgICAgLy8gY291bnQgcGVyIHBhZ2VcbiAgICAgICAgc29ydGluZzoge1xuICAgICAgICAgICAgdXBkYXRlZF9hdDogJ2Rlc2MnICAgICAvLyBpbml0aWFsIHNvcnRpbmdcbiAgICAgICAgfSxcbiAgICB9LCB7XG4gICAgICAgIGZpbHRlckRlbGF5OiAxMCxcbiAgICAgICAgdG90YWw6ICRzY29wZS5kYXRhLmxlbmd0aCwgLy8gbGVuZ3RoIG9mIGRhdGFcbiAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24oJGRlZmVyLCBwYXJhbXMpIHtcbiAgICAgICAgICAgIC8vIHVzZSBidWlsZC1pbiBhbmd1bGFyIGZpbHRlclxuICAgICAgICAgICAgdmFyIGZpbHRlcmVkRGF0YSA9IHBhcmFtcy5maWx0ZXIoKSA/XG4gICAgICAgICAgICAgICAgICAgICRmaWx0ZXIoJ2ZpbHRlcicpKCRzY29wZS5kYXRhLCBwYXJhbXMuZmlsdGVyKCkpIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE7XG4gICAgICAgICAgICB2YXIgb3JkZXJlZERhdGEgPSBwYXJhbXMuc29ydGluZygpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignb3JkZXJCeScpKGZpbHRlcmVkRGF0YSwgcGFyYW1zLm9yZGVyQnkoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTtcblxuICAgICAgICAgICAgcGFyYW1zLnRvdGFsKG9yZGVyZWREYXRhLmxlbmd0aCk7IC8vIHNldCB0b3RhbCBmb3IgcmVjYWxjIHBhZ2luYXRpb25cbiAgICAgICAgICAgICRkZWZlci5yZXNvbHZlKG9yZGVyZWREYXRhLnNsaWNlKChwYXJhbXMucGFnZSgpIC0gMSkgKiBwYXJhbXMuY291bnQoKSwgcGFyYW1zLnBhZ2UoKSAqIHBhcmFtcy5jb3VudCgpKSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEluaXRpYWxpc2UgKGxvYWQpIGRhdGFcbiAgICAkc2NvcGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIC8vY29uc29sZS5sb2coUmVzdGZ1bEFwaS5nZXRSb3V0ZSgncHJvamVjdCcsICd1cGRhdGUnLCA0KSk7XG5cbiAgICAgICAgJGh0dHAuZ2V0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3Byb2plY3QnLCAnaW5kZXgnKSkuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgIH0pO1xuXG4gICAgfTtcblxuXG4gICAgJHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uKGlkLCB0aXRsZSkge1xuXG4gICAgICAgIGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlICcgKyB0aXRsZSArICc/JykpIHtcblxuICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCcvYWRtaW4vYXBpL3Byb2plY3QvJyArIGlkKS5cbiAgICAgICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiUHJvamVjdCAnXCIgKyBkYXRhLnRpdGxlICsgXCInIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5XCIsICdpbmZvJyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbml0KCk7XG4gICAgICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmluaXQoKTtcblxuXG59KTtcblxuXG5cbmFwcC5jb250cm9sbGVyKCdQcm9qZWN0Q3JlYXRlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IHt9O1xuXG4gICAgJHNjb3BlLmNyZWF0ZSA9IHRydWU7XG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKGFwcGx5KSB7XG5cbiAgICAgICAgJGh0dHAucG9zdChSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3N0b3JlJyksICRzY29wZS5kYXRhKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiUHJvamVjdCAnXCIgKyBkYXRhLnRpdGxlICsgXCInIGFkZGVkIHN1Y2Nlc3NmdWxseVwiLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoIWFwcGx5KSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbyggXCJwcm9qZWN0LmluZGV4XCIgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInByb2plY3QuZWRpdFwiLCB7aWQ6IGRhdGEuaWR9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdQcm9qZWN0RWRpdENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSwgbmdUYWJsZVBhcmFtcywgJGZpbHRlciwgJG1vZGFsKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IHtcbiAgICAgICAgc2VjdGlvbnMgOiBbXVxuICAgIH07XG5cblxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBuZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgcGFnZTogMSwgICAgICAgICAgICAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgY291bnQ6IDEwLCAgICAgICAgICAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnZGVzYycgICAgIC8vIGluaXRpYWwgc29ydGluZ1xuICAgICAgICB9LFxuICAgIH0sIHtcbiAgICAgICAgZmlsdGVyRGVsYXk6IDEwLFxuICAgICAgICB0b3RhbDogJHNjb3BlLmRhdGEuc2VjdGlvbnMubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbigkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdXNlIGJ1aWxkLWluIGFuZ3VsYXIgZmlsdGVyXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhID0gcGFyYW1zLmZpbHRlcigpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmRhdGEuc2VjdGlvbnMsIHBhcmFtcy5maWx0ZXIoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9ucztcbiAgICAgICAgICAgIHZhciBvcmRlcmVkRGF0YSA9IHBhcmFtcy5zb3J0aW5nKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdvcmRlckJ5JykoZmlsdGVyZWREYXRhLCBwYXJhbXMub3JkZXJCeSgpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnNlY3Rpb25zO1xuXG4gICAgICAgICAgICBwYXJhbXMudG90YWwob3JkZXJlZERhdGEubGVuZ3RoKTsgLy8gc2V0IHRvdGFsIGZvciByZWNhbGMgcGFnaW5hdGlvblxuICAgICAgICAgICAgJGRlZmVyLnJlc29sdmUob3JkZXJlZERhdGEuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICAkaHR0cC5nZXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgncHJvamVjdCcsICdzaG93JywgJHN0YXRlUGFyYW1zLmlkKSkuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUuc2x1ZyA9ICRzY29wZS5kYXRhLnNsdWc7XG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgfSk7XG5cblxuXG4gICAgJHNjb3BlLmVkaXRTZWN0aW9uID0gZnVuY3Rpb24gKGNyZWF0ZSwgc2VjdGlvbklkKSB7XG4gICAgICAgIHNlY3Rpb25JZCA9IHR5cGVvZiBzZWN0aW9uSWQgIT09ICd1bmRlZmluZWQnID8gc2VjdGlvbklkIDogZmFsc2U7XG5cbiAgICAgICAgbW9kYWxEYXRhID0ge1xuICAgICAgICAgICAgJ2NyZWF0ZScgOiBjcmVhdGUsXG4gICAgICAgICAgICAncHJvamVjdElkJyA6ICRzY29wZS5kYXRhLmlkLFxuICAgICAgICAgICAgJ3NlY3Rpb25JZCcgOiBzZWN0aW9uSWRcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zb2xlLmxvZyhtb2RhbERhdGEpO1xuXG4gICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgYW5pbWF0aW9uOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzZWN0aW9uRWRpdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdlZGl0U2VjdGlvbkNvbnRyb2xsZXInLFxuICAgICAgICAgICAgc2l6ZTogJ2xnJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICBtb2RhbERhdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kYWxEYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VjdGlvbiwgY3JlYXRlKSB7XG4gICAgICAgICAgICBpZiAoY3JlYXRlKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc2VjdGlvbnMucHVzaChzZWN0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmRhdGEuc2VjdGlvbnMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLmlkID09IHNlY3Rpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc2VjdGlvbnNbdmFsdWUuaWRdID0gc2VjdGlvblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgfTtcblxuXG4gICAgJHNjb3BlLnNsdWdXYXJuaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UucmVtb3ZlQnlUeXBlKCd3YXJuaW5nJyk7XG4gICAgICAgIGlmICgkc2NvcGUuc2x1ZyAhPSAkc2NvcGUuZGF0YS5zbHVnKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIllvdSBoYXZlIG1vZGlmaWVkIHRoZSBwcm9qZWN0IHNsdWcuIFBsZWFzZSBiZSBhd2FyZSB0aGF0IHRoaXMgbWF5IGJyZWFrIGh5cGVybGlua3MgdG8gdGhpcyBwcm9qZWN0LlwiLCAnd2FybmluZycpO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKGFwcGx5KSB7XG4gICAgICAgIGFwcGx5ID0gdHlwZW9mIGFwcGx5ICE9PSAndW5kZWZpbmVkJyA/IGFwcGx5IDogZmFsc2U7XG5cbiAgICAgICAgaWYgKCRzY29wZS5zbHVnICE9ICRzY29wZS5kYXRhLnNsdWcpIHtcbiAgICAgICAgICAgIGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gY2hhbmdlIHRoZSBzbHVnPycpKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnB1dChhcHBseSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnNsdWcgPSAkc2NvcGUuc2x1ZztcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnJlbW92ZUJ5VHlwZSgnd2FybmluZycpO1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiU2x1ZyByZXNldFwiLCAnaW5mbycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLnB1dChhcHBseSk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgICRzY29wZS5wdXQgPSBmdW5jdGlvbihhcHBseSkge1xuICAgICAgICAkaHR0cC5wdXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgncHJvamVjdCcsICd1cGRhdGUnLCAkc3RhdGVQYXJhbXMuaWQpLCAkc2NvcGUuZGF0YSkuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIlByb2plY3QgJ1wiICsgZGF0YS50aXRsZSArIFwiJyB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgaWYgKCFhcHBseSkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbyggXCJwcm9qZWN0LmluZGV4XCIgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxufSk7XG5cblxuXG5cblxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRTZWN0aW9uQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbW9kYWxJbnN0YW5jZSwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSwgbW9kYWxEYXRhKSB7XG5cbiAgICBpZiAoIW1vZGFsRGF0YS5jcmVhdGUpIHtcblxuICAgICAgICAkaHR0cC5nZXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgnc2VjdGlvbicsICdzaG93JywgbW9kYWxEYXRhLnNlY3Rpb25JZCkpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlY3Rpb24gPSBkYXRhO1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG5cbiAgICB9XG5cblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc29sZS5sb2cobW9kYWxEYXRhLnByb2plY3RJZCk7XG5cbiAgICAgICAgaWYgKG1vZGFsRGF0YS5jcmVhdGUpe1xuXG4gICAgICAgICAgICAkaHR0cC5wb3N0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3Byb2plY3RTZWN0aW9uJywgJ3N0b3JlJywgbW9kYWxEYXRhLnByb2plY3RJZCksICRzY29wZS5zZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiU2VjdGlvbiAnXCIgKyBkYXRhLnRpdGxlICsgXCInIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XCIsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoZGF0YSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICRodHRwLnB1dChSZXN0ZnVsQXBpLmdldFJvdXRlKCdzZWN0aW9uJywgJ3VwZGF0ZScsICRzY29wZS5zZWN0aW9uLmlkKSwgJHNjb3BlLnNlY3Rpb24pXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJTZWN0aW9uICdcIiArIGRhdGEudGl0bGUgKyBcIicgdXBkYXRlZCBzdWNjZXNzZnVsbHlcIiwgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShkYXRhLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICB9O1xufSk7XG5cbmFwcC5jb250cm9sbGVyKCdQcm9qZWN0U2VjdGlvbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRmaWx0ZXIsIG5nVGFibGVQYXJhbXMsICRodHRwLCAkcm91dGUsICRyb3V0ZVBhcmFtcywgJGxvY2F0aW9uKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IFtdO1xuXG4gICAgLy8gSW5pdGlhbGlzZSB0aGUgZGF0YSB0YWJsZVxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBuZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgcGFnZTogMSwgICAgICAgICAgICAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgY291bnQ6IDEwLCAgICAgICAgICAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICBjcmVhdGVkX2F0OiAnZGVzYycgICAgIC8vIGluaXRpYWwgc29ydGluZ1xuICAgICAgICB9LFxuICAgIH0sIHtcbiAgICAgICAgZmlsdGVyRGVsYXk6IDEwLFxuICAgICAgICB0b3RhbDogJHNjb3BlLmRhdGEubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbigkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdXNlIGJ1aWxkLWluIGFuZ3VsYXIgZmlsdGVyXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhID0gcGFyYW1zLmZpbHRlcigpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmRhdGEsIHBhcmFtcy5maWx0ZXIoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTtcbiAgICAgICAgICAgIHZhciBvcmRlcmVkRGF0YSA9IHBhcmFtcy5zb3J0aW5nKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdvcmRlckJ5JykoZmlsdGVyZWREYXRhLCBwYXJhbXMub3JkZXJCeSgpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhO1xuXG4gICAgICAgICAgICBwYXJhbXMudG90YWwob3JkZXJlZERhdGEubGVuZ3RoKTsgLy8gc2V0IHRvdGFsIGZvciByZWNhbGMgcGFnaW5hdGlvblxuICAgICAgICAgICAgJGRlZmVyLnJlc29sdmUob3JkZXJlZERhdGEuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zb2xlLmxvZygkcm91dGVQYXJhbXMucHJvamVjdF9pZCk7XG5cbiAgICAgICAgJGh0dHAuZ2V0KCcvYWRtaW4vYXBpL3Byb2plY3QvJyArICRyb3V0ZVBhcmFtcy5wcm9qZWN0X2lkICsgJy9zZWN0aW9uJykuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcblxuICAgICAgICAgICAgLy8gUGFyc2UgSUQgZnJvbSB0ZXh0IHRvIGludGVnZXJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGRhdGEuaWQgID0gcGFyc2VGbG9hdChkYXRhLmlkKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG5cbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdGF0dXMpO1xuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW3tcIkxvZ2dlZCBvdXRcIiA6IFwiWW91IGhhdmUgYmVlbiBsb2dnZWQgb3V0LiBSZWZyZXNoIHRoZSBwYWdlIHRvIGxvZyBiYWNrIGluIGFnYWluXCJ9XTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuZGVsZXRlID0gZnVuY3Rpb24oaWQpIHtcblxuICAgICAgICAkaHR0cC5kZWxldGUoJy9hZG1pbi9hcGkvcHJvamVjdC8nICsgaWQpLlxuICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5pdCgpO1xuICAgICAgICAgIH0pLlxuICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmluaXQoKTtcblxufSk7XG5cblxuXG5hcHAuY29udHJvbGxlcignU2VjdGlvbkNyZWF0ZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkcm91dGUsICRyb3V0ZVBhcmFtcywgJGxvY2F0aW9uKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IHt9O1xuXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvYWRtaW4vYXBpL3Byb2plY3QnLCAkc2NvcGUuZGF0YSkuXG4gICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoIFwiL3Byb2plY3RcIiApO1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbe1wiTG9nZ2VkIG91dFwiIDogXCJZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQuIFJlZnJlc2ggdGhlIHBhZ2UgdG8gbG9nIGJhY2sgaW4gYWdhaW5cIn1dO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ1NlY3Rpb25FZGl0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRyb3V0ZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24pIHtcblxuICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAkaHR0cC5nZXQoJy9hZG1pbi9hcGkvc2VjdGlvbi8nICsgJHJvdXRlUGFyYW1zLmlkKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFt7XCJMb2dnZWQgb3V0XCIgOiBcIllvdSBoYXZlIGJlZW4gbG9nZ2VkIG91dC4gUmVmcmVzaCB0aGUgcGFnZSB0byBsb2cgYmFjayBpbiBhZ2FpblwifV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuXG4gICAgJHNjb3BlLmFkZFNlY3Rpb24gPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9ucy5wdXNoKHt9KTtcblxuICAgIH07XG5cbiAgICAkc2NvcGUuZGVsZXRlU2VjdGlvbiA9IGZ1bmN0aW9uKGluZGV4KSB7XG5cbiAgICAgICAgJHNjb3BlLmRhdGEuc2VjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgIH07XG5cblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJGh0dHAucHV0KCcvYWRtaW4vYXBpL3NlY3Rpb24vJyArICRyb3V0ZVBhcmFtcy5pZCwgJHNjb3BlLmRhdGEpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuXG5cbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCggXCIvcHJvamVjdC9cIiArIGRhdGEuYXR0YWNobWVudF9pZCArIFwiL3NlY3Rpb25cIik7XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFt7XCJMb2dnZWQgb3V0XCIgOiBcIllvdSBoYXZlIGJlZW4gbG9nZ2VkIG91dC4gUmVmcmVzaCB0aGUgcGFnZSB0byBsb2cgYmFjayBpbiBhZ2FpblwifV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG59KTtcbmFwcC5jb250cm9sbGVyKCdUYWdDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyLCBuZ1RhYmxlUGFyYW1zLCAkaHR0cCwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSkge1xuXG4gICAgLy8gSW5pdGlhbGlzZSBhbiBlbXB0eSBhcnJheSB0byBob2xkIGRhdGFcbiAgICAkc2NvcGUuZGF0YSA9IFtdO1xuXG4gICAgLy8gSW5pdGlhbGlzZSB0aGUgZGF0YSB0YWJsZVxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBuZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgcGFnZTogMSwgICAgICAgICAgICAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgY291bnQ6IDEwLCAgICAgICAgICAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnZGVzYycgICAgIC8vIGluaXRpYWwgc29ydGluZ1xuICAgICAgICB9LFxuICAgIH0sIHtcbiAgICAgICAgZmlsdGVyRGVsYXk6IDEwLFxuICAgICAgICB0b3RhbDogJHNjb3BlLmRhdGEubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbigkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdXNlIGJ1aWxkLWluIGFuZ3VsYXIgZmlsdGVyXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhID0gcGFyYW1zLmZpbHRlcigpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmRhdGEsIHBhcmFtcy5maWx0ZXIoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTtcbiAgICAgICAgICAgIHZhciBvcmRlcmVkRGF0YSA9IHBhcmFtcy5zb3J0aW5nKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdvcmRlckJ5JykoZmlsdGVyZWREYXRhLCBwYXJhbXMub3JkZXJCeSgpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhO1xuXG4gICAgICAgICAgICBwYXJhbXMudG90YWwob3JkZXJlZERhdGEubGVuZ3RoKTsgLy8gc2V0IHRvdGFsIGZvciByZWNhbGMgcGFnaW5hdGlvblxuICAgICAgICAgICAgJGRlZmVyLnJlc29sdmUob3JkZXJlZERhdGEuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gSW5pdGlhbGlzZSAobG9hZCkgZGF0YVxuICAgICRzY29wZS5pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3VwZGF0ZScsIDQpKTtcblxuICAgICAgICAkaHR0cC5nZXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgndGFnJywgJ2luZGV4JykpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICB9KTtcblxuICAgIH07XG5cblxuICAgICRzY29wZS5kZWxldGUgPSBmdW5jdGlvbihpZCwgdGl0bGUpIHtcblxuICAgICAgICBpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3aXNoIHRvIGRlbGV0ZSAnICsgdGl0bGUgKyAnPycpKSB7XG5cbiAgICAgICAgICAgICRodHRwLmRlbGV0ZShSZXN0ZnVsQXBpLmdldFJvdXRlKCd0YWcnLCAnZGVzdHJveScsIGlkKSkuXG4gICAgICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIlByb2plY3QgJ1wiICsgZGF0YS50aXRsZSArIFwiJyBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiLCAnaW5mbycpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW5pdCgpO1xuICAgICAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5pbml0KCk7XG5cblxufSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ1RhZ0NyZWF0ZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSkge1xuXG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcblxuICAgICRzY29wZS5jcmVhdGUgPSB0cnVlO1xuXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihhcHBseSkge1xuXG4gICAgICAgICRodHRwLnBvc3QoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgndGFnJywgJ3N0b3JlJyksICRzY29wZS5kYXRhKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiVGFnICdcIiArIGRhdGEudGl0bGUgKyBcIicgYWRkZWQgc3VjY2Vzc2Z1bGx5XCIsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmICghYXBwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInRhZy5pbmRleFwiICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICRzdGF0ZS5nbyggXCJ0YWcuZWRpdFwiLCB7aWQ6IGRhdGEuaWR9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdUYWdFZGl0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlLCBuZ1RhYmxlUGFyYW1zLCAkZmlsdGVyLCAkbW9kYWwpIHtcblxuICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAkaHR0cC5nZXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgndGFnJywgJ3Nob3cnLCAkc3RhdGVQYXJhbXMuaWQpKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICB9KTtcblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oYXBwbHkpIHtcbiAgICAgICAgYXBwbHkgPSB0eXBlb2YgYXBwbHkgIT09ICd1bmRlZmluZWQnID8gYXBwbHkgOiBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnB1dChhcHBseSk7XG4gICAgfVxuXG4gICAgJHNjb3BlLnB1dCA9IGZ1bmN0aW9uKGFwcGx5KSB7XG4gICAgICAgICRodHRwLnB1dChSZXN0ZnVsQXBpLmdldFJvdXRlKCd0YWcnLCAndXBkYXRlJywgJHN0YXRlUGFyYW1zLmlkKSwgJHNjb3BlLmRhdGEpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJUYWcgJ1wiICsgZGF0YS50aXRsZSArIFwiJyB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgaWYgKCFhcHBseSkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbyggXCJ0YWcuaW5kZXhcIiApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG59KTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9