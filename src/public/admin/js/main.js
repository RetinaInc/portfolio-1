var app=angular.module("ng-portfolio",["ui.router","ui.bootstrap","ngTable","hc.marked"]);app.config(function($httpProvider){$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"});app.config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/dashboard");$stateProvider.state("dashboard",{url:"/dashboard",templateUrl:"/vendor/portfolio/admin/views/dashboard.html",controller:"DashboardController"}).state("project",{url:"/project",templateUrl:"/vendor/portfolio/admin/views/project/project.html"}).state("project.index",{url:"/index",templateUrl:"/vendor/portfolio/admin/views/project/project.index.html",controller:"ProjectController"}).state("project.create",{url:"/create",templateUrl:"/vendor/portfolio/admin/views/project/project.edit.html",controller:"ProjectCreateController"}).state("project.edit",{url:"/:id/edit",templateUrl:"/vendor/portfolio/admin/views/project/project.edit.html",controller:"ProjectEditController"}).state("project-section",{url:"/project/:id/section",templateUrl:"/vendor/portfolio/admin/views/project/project.section.index.html",controller:"ProjectSectionController"}).state("section-edit",{url:"/section/:id/edit",templateUrl:"/vendor/portfolio/admin/views/section/section.edit.html",controller:"SectionEditController"}).state("tag",{url:"/tag",templateUrl:"/vendor/portfolio/admin/views/tag/tag.html"}).state("tag.index",{url:"/index",templateUrl:"/vendor/portfolio/admin/views/tag/tag.index.html",controller:"TagController"}).state("tag.create",{url:"/create",templateUrl:"/vendor/portfolio/admin/views/tag/tag.edit.html",controller:"TagCreateController"}).state("tag.edit",{url:"/:id/edit",templateUrl:"/vendor/portfolio/admin/views/tag/tag.edit.html",controller:"TagEditController"})});app.config(["markedProvider",function(markedProvider){markedProvider.setOptions({gfm:true,tables:true})}]);app.factory("RestfulApi",function($http,notificationService){var checkResponseCode=function(data,status){switch(status){case 422:notificationService.clear();var msg=[];angular.forEach(data,function(value,key){msg=msg.concat(value)});notificationService.add("Validation failed, please correct the following issues:","danger",msg);break;case 401:notificationService.add("You have been logged out","warning");break;case 500:notificationService.add("API error","danger");break;default:console.log("Some other problem!");console.log(data)}};return{getRoute:function(resource,method,id){if(typeof id==="undefined"){id="0"}var prefix="/admin/api";var routes={project:{index:prefix+"/project",show:prefix+"/project/"+id,store:prefix+"/project",update:prefix+"/project/"+id,destroy:prefix+"/project/"+id},section:{index:prefix+"/section",show:prefix+"/section/"+id,store:prefix+"/section",update:prefix+"/section/"+id,destroy:prefix+"/section/"+id},projectSection:{store:prefix+"/project/"+id+"/section"},tag:{index:prefix+"/tag",show:prefix+"/tag/"+id,store:prefix+"/tag",update:prefix+"/tag/"+id,destroy:prefix+"/tag/"+id}};return routes[resource][method]},success:function(data,status,headers,config){notificationService.removeByType("danger");return data},error:function(data,status,headers,config){checkResponseCode(data,status);return data}}});app.service("notificationService",function($timeout){var notifications=[];this.get=function(){return notifications};this.add=function(message,type,messages){if(type=="success"){this.removeByType("success")}var notification={type:type,message:message,messages:messages};notifications.push(notification);console.log("added "+type+" message");if(type!="danger"){$timeout(function(){notifications.splice(notifications.indexOf(notification),1)},6e3)}};this.removeByIndex=function(index){console.log("removing one message: "+index);notifications.splice(index,1)};this.removeByType=function(type){console.log("clearing "+type+" messages");for(i=0;i<notifications.length;i++){if(notifications[i].type==type){notifications.splice(i,1)}}};this.clear=function(){console.log("clearing all messages");notifications=[]}});app.controller("NotificationController",function($scope,notificationService,$timeout){$scope.notifier=notificationService;$scope.$watch("notifier.get()",function(notifications){if(angular.isDefined(notifications)){$scope.notifications=notifications}},true);$scope.closeNotification=function(index){notificationService.removeByIndex(index)}});app.controller("DashboardController",function($scope,$http,$stateParams){});app.controller("ProjectController",function($scope,$filter,ngTableParams,$http,RestfulApi,notificationService){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){$http.get(RestfulApi.getRoute("project","index")).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config)})};$scope.delete=function(id,title){if(confirm("Are you sure you wish to delete "+title+"?")){$http.delete("/admin/api/project/"+id).success(function(data,status,headers,config){notificationService.add("Project '"+data.title+"' deleted successfully","info");$scope.init()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.init()});app.controller("ProjectCreateController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService){$scope.data={};$scope.create=true;$scope.save=function(apply){$http.post(RestfulApi.getRoute("project","store"),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Project '"+data.title+"' added successfully","success");$scope.errors=[];if(!apply){$state.go("project.index")}else{$state.go("project.edit",{id:data.id})}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("ProjectEditController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService,ngTableParams,$filter,$modal){$scope.data={sections:[]};$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.sections.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data.sections,params.filter()):$scope.data.sections;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data.sections;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$http.get(RestfulApi.getRoute("project","show",$stateParams.id)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.slug=$scope.data.slug;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data});$scope.editSection=function(create,sectionId){sectionId=typeof sectionId!=="undefined"?sectionId:false;modalData={create:create,projectId:$scope.data.id,sectionId:sectionId};console.log(modalData);var modalInstance=$modal.open({animation:true,templateUrl:"sectionEdit.html",controller:"editSectionController",size:"lg",resolve:{modalData:function(){return modalData}}});modalInstance.result.then(function(section,create){if(create){$scope.data.sections.push(section)}else{angular.forEach($scope.data.sections,function(value,key){if(value.id==sectionId){$scope.data.sections[value.id]=section}})}$scope.tableParams.reload()},function(){})};$scope.slugWarning=function(){notificationService.removeByType("warning");if($scope.slug!=$scope.data.slug){notificationService.add("You have modified the project slug. Please be aware that this may break hyperlinks to this project.","warning")}};$scope.save=function(apply){apply=typeof apply!=="undefined"?apply:false;if($scope.slug!=$scope.data.slug){if(confirm("Are you sure you wish to change the slug?")){$scope.put(apply)}else{$scope.data.slug=$scope.slug;notificationService.removeByType("warning");notificationService.add("Slug reset","info")}}else{$scope.put(apply)}};$scope.put=function(apply){$http.put(RestfulApi.getRoute("project","update",$stateParams.id),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Project '"+data.title+"' updated successfully","success");$scope.errors=[];if(!apply){$state.go("project.index")}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("editSectionController",function($scope,$http,$modalInstance,RestfulApi,notificationService,modalData){if(!modalData.create){$http.get(RestfulApi.getRoute("section","show",modalData.sectionId)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.section=data}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}$scope.save=function(){console.log(modalData.projectId);if(modalData.create){$http.post(RestfulApi.getRoute("projectSection","store",modalData.projectId),$scope.section).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Section '"+data.title+"' created successfully","success");$scope.errors=[];$modalInstance.close(data,true)}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}else{$http.put(RestfulApi.getRoute("section","update",$scope.section.id),$scope.section).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Section '"+data.title+"' updated successfully","success");$scope.errors=[];$modalInstance.close(data,false)}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.cancel=function(){$modalInstance.dismiss("cancel")}});app.controller("ProjectSectionController",function($scope,$filter,ngTableParams,$http,$route,$routeParams,$location){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{created_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){console.log($routeParams.project_id);$http.get("/admin/api/project/"+$routeParams.project_id+"/section").success(function(data,status,headers,config){$scope.data=data;angular.forEach(data,function(data){data.id=parseFloat(data.id)});$scope.tableParams.reload()}).error(function(data,status,headers,config){console.log(status);if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})};$scope.delete=function(id){$http.delete("/admin/api/project/"+id).success(function(data,status,headers,config){$scope.init()}).error(function(data,status,headers,config){$scope.errors=data})};$scope.init()});app.controller("SectionCreateController",function($scope,$http,$route,$routeParams,$location){$scope.data={};$scope.save=function(){$http.post("/admin/api/project",$scope.data).success(function(data,status,headers,config){$location.path("/project")}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})}});app.controller("SectionEditController",function($scope,$http,$route,$routeParams,$location){$scope.data={};$http.get("/admin/api/section/"+$routeParams.id).success(function(data,status,headers,config){$scope.data=data}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}});$scope.addSection=function(){$scope.data.sections.push({})};$scope.deleteSection=function(index){$scope.data.sections.splice(index,1)};$scope.save=function(){$http.put("/admin/api/section/"+$routeParams.id,$scope.data).success(function(data,status,headers,config){$location.path("/project/"+data.attachment_id+"/section")}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})}});app.controller("TagController",function($scope,$filter,ngTableParams,$http,RestfulApi,notificationService){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){$http.get(RestfulApi.getRoute("tag","index")).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config)})};$scope.delete=function(id,title){if(confirm("Are you sure you wish to delete "+title+"?")){$http.delete(RestfulApi.getRoute("tag","destroy",id)).success(function(data,status,headers,config){notificationService.add("Project '"+data.title+"' deleted successfully","info");$scope.init()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.init()});app.controller("TagCreateController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService){$scope.data={};$scope.create=true;$scope.save=function(apply){$http.post(RestfulApi.getRoute("tag","store"),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Tag '"+data.title+"' added successfully","success");$scope.errors=[];if(!apply){$state.go("tag.index")}else{$state.go("tag.edit",{id:data.id})}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("TagEditController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService,ngTableParams,$filter,$modal){$scope.data={};$http.get(RestfulApi.getRoute("tag","show",$stateParams.id)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data});$scope.save=function(apply){apply=typeof apply!=="undefined"?apply:false;$scope.put(apply)};$scope.put=function(apply){$http.put(RestfulApi.getRoute("tag","update",$stateParams.id),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Tag '"+data.title+"' updated successfully","success");$scope.errors=[];if(!apply){$state.go("tag.index")}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9wdWJsaWMvYWRtaW4vanMvbWFpbi5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJtYXJrZWRQcm92aWRlciIsInNldE9wdGlvbnMiLCJnZm0iLCJ0YWJsZXMiLCJmYWN0b3J5IiwiJGh0dHAiLCJub3RpZmljYXRpb25TZXJ2aWNlIiwiY2hlY2tSZXNwb25zZUNvZGUiLCJkYXRhIiwic3RhdHVzIiwiY2xlYXIiLCJtc2ciLCJmb3JFYWNoIiwidmFsdWUiLCJrZXkiLCJjb25jYXQiLCJhZGQiLCJjb25zb2xlIiwibG9nIiwiZ2V0Um91dGUiLCJyZXNvdXJjZSIsIm1ldGhvZCIsImlkIiwicHJlZml4Iiwicm91dGVzIiwicHJvamVjdCIsImluZGV4Iiwic2hvdyIsInN0b3JlIiwidXBkYXRlIiwiZGVzdHJveSIsInNlY3Rpb24iLCJwcm9qZWN0U2VjdGlvbiIsInRhZyIsInN1Y2Nlc3MiLCJyZW1vdmVCeVR5cGUiLCJlcnJvciIsInNlcnZpY2UiLCIkdGltZW91dCIsIm5vdGlmaWNhdGlvbnMiLCJ0aGlzIiwiZ2V0IiwibWVzc2FnZSIsInR5cGUiLCJtZXNzYWdlcyIsIm5vdGlmaWNhdGlvbiIsInB1c2giLCJzcGxpY2UiLCJpbmRleE9mIiwicmVtb3ZlQnlJbmRleCIsImkiLCJsZW5ndGgiLCIkc2NvcGUiLCJub3RpZmllciIsIiR3YXRjaCIsImlzRGVmaW5lZCIsImNsb3NlTm90aWZpY2F0aW9uIiwiJHN0YXRlUGFyYW1zIiwiJGZpbHRlciIsIm5nVGFibGVQYXJhbXMiLCJSZXN0ZnVsQXBpIiwidGFibGVQYXJhbXMiLCJwYWdlIiwiY291bnQiLCJzb3J0aW5nIiwidXBkYXRlZF9hdCIsImZpbHRlckRlbGF5IiwidG90YWwiLCJnZXREYXRhIiwiJGRlZmVyIiwicGFyYW1zIiwiZmlsdGVyZWREYXRhIiwiZmlsdGVyIiwib3JkZXJlZERhdGEiLCJvcmRlckJ5IiwicmVzb2x2ZSIsInNsaWNlIiwiaW5pdCIsInJlbG9hZCIsImRlbGV0ZSIsInRpdGxlIiwiY29uZmlybSIsImVycm9ycyIsIiRzdGF0ZSIsImNyZWF0ZSIsInNhdmUiLCJhcHBseSIsInBvc3QiLCJnbyIsIiRtb2RhbCIsInNlY3Rpb25zIiwic2x1ZyIsImVkaXRTZWN0aW9uIiwic2VjdGlvbklkIiwibW9kYWxEYXRhIiwicHJvamVjdElkIiwibW9kYWxJbnN0YW5jZSIsIm9wZW4iLCJhbmltYXRpb24iLCJzaXplIiwicmVzdWx0IiwidGhlbiIsInNsdWdXYXJuaW5nIiwicHV0IiwiJG1vZGFsSW5zdGFuY2UiLCJjbG9zZSIsImNhbmNlbCIsImRpc21pc3MiLCIkcm91dGUiLCIkcm91dGVQYXJhbXMiLCIkbG9jYXRpb24iLCJjcmVhdGVkX2F0IiwicHJvamVjdF9pZCIsInBhcnNlRmxvYXQiLCJMb2dnZWQgb3V0IiwicGF0aCIsImFkZFNlY3Rpb24iLCJkZWxldGVTZWN0aW9uIiwiYXR0YWNobWVudF9pZCJdLCJtYXBwaW5ncyI6IkFBQ0EsR0FBSUEsS0FBTUMsUUFBUUMsT0FBTyxnQkFBaUIsWUFBYSxlQUFnQixVQUFXLGFBVWxGRixLQUFJRyxPQUFPLFNBQVNDLGVBRWhCQSxjQUFjQyxTQUFTQyxRQUFRQyxPQUFPLG9CQUFzQixrQkFLaEVQLEtBQUlHLE9BQU8sU0FBU0ssZUFBZ0JDLG9CQUdsQ0EsbUJBQW1CQyxVQUFVLGFBSzdCRixnQkFDR0csTUFBTSxhQUNMQyxJQUFLLGFBQ0xDLFlBQWEsK0NBQ2JDLFdBQVksd0JBRWJILE1BQU0sV0FDTEMsSUFBSyxXQUNMQyxZQUFhLHVEQUVkRixNQUFNLGlCQUNMQyxJQUFLLFNBQ0xDLFlBQWEsMkRBQ2JDLFdBQVksc0JBRWJILE1BQU0sa0JBQ0xDLElBQUss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UWxCLFFBQVNILFFBQ2xDd0UsV0FBV3hCLE1BQU01QixLQUFNQyxPQUFRbEIsUUFBU0gsT0FDeENnRSxRQUFPOEIsT0FBUzFFLE1BR3hCNEMsUUFBT2lDLEtBQU8sU0FBU0MsT0FDbkJBLFlBQWVBLFNBQVUsWUFBY0EsTUFBUSxLQUMvQ2xDLFFBQU9tRCxJQUFJakIsT0FHZmxDLFFBQU9tRCxJQUFNLFNBQVNqQixPQUNsQmpGLE1BQU1rRyxJQUFJM0MsV0FBV3pDLFNBQVMsTUFBTyxTQUFVc0MsYUFBYW5DLElBQUs4QixPQUFPNUMsTUFDeEUwQixRQUFRLFNBQVMxQixLQUFNQyxPQUFRbEIsUUFBU0gsUUFDcEN3RSxXQUFXMUIsUUFBUTFCLEtBQU1DLE9BQVFsQixRQUFTSCxPQUMxQ2tCLHFCQUFvQlUsSUFBSSxRQUFVUixLQUFLd0UsTUFBUSx5QkFBMEIsVUFDekU1QixRQUFPOEIsU0FDUCxLQUFLSSxNQUFPLENBQ1JILE9BQU9LLEdBQUksZ0JBR25CcEQsTUFBTSxTQUFTNUIsS0FBTUMsT0FBUWxCLFFBQVNILFFBQ2xDd0UsV0FBV3hCLE1BQU01QixLQUFNQyxPQUFRbEIsUUFBU0gsT0FDeENnRSxRQUFPOEIsT0FBUzFFIiwiZmlsZSI6InNyYy9wdWJsaWMvYWRtaW4vanMvbWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEZpcmUgdXAgdGhlIGFwcFxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCduZy1wb3J0Zm9saW8nLCBbJ3VpLnJvdXRlcicsICd1aS5ib290c3RyYXAnLCAnbmdUYWJsZScsICdoYy5tYXJrZWQnXSk7XG5cbi8vIENvbmZpZ3VyZSBBbmd1bGFyXG5cbi8qIGFwcC5jb25maWcoZnVuY3Rpb24oJGludGVycG9sYXRlUHJvdmlkZXIpIHtcbiAgICAvLyBTZXQgQW5ndWxhciB0byB1c2Ugc3F1YXJlLWJyYWNrZXRzIGluc3RlYWQgb2YgY3VybHkgLSBhIHdvcmsgYXJvdW5kIHRvIHBsYXkgbmljZSB3aXRoIExhcmF2ZWwgQmxhZGUgdGVtcGxhdGVzXG4gICAgJGludGVycG9sYXRlUHJvdmlkZXIuc3RhcnRTeW1ib2woJ3t7Jyk7XG4gICAgJGludGVycG9sYXRlUHJvdmlkZXIuZW5kU3ltYm9sKCd9fScpO1xufSk7ICovXG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xuICAgIC8vIEFkZCB0aGUgWE1MSHR0cFJlcXVlc3QgaGVhZGVyIHNvIHRoYXQgTGFyYXZlbCBjYW4gdGVsbCBhcGFydCBBSkFYIHJlcXVlc3RzXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbltcIlgtUmVxdWVzdGVkLVdpdGhcIl0gPSBcIlhNTEh0dHBSZXF1ZXN0XCI7XG59KTtcblxuXG4vLyBTZXR1cCB0aGUgc3RhdGUgbWFuYWdlciAoUm91dGVyKVxuYXBwLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgLy8gRm9yIGFueSB1bm1hdGNoZWQgdXJsLCByZWRpcmVjdCB0byAvc3RhdGUxXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvZGFzaGJvYXJkXCIpO1xuXG4gIC8vJHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9wcm9qZWN0JywgJy9wcm9qZWN0L2luZGV4Jyk7XG5cbiAgLy8gTm93IHNldCB1cCB0aGUgc3RhdGVzXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdkYXNoYm9hcmQnLCB7XG4gICAgICB1cmw6IFwiL2Rhc2hib2FyZFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvZGFzaGJvYXJkLmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiRGFzaGJvYXJkQ29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2plY3QnLCB7XG4gICAgICB1cmw6IFwiL3Byb2plY3RcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3Byb2plY3QvcHJvamVjdC5odG1sXCIsXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2plY3QuaW5kZXgnLCB7XG4gICAgICB1cmw6IFwiL2luZGV4XCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9wcm9qZWN0L3Byb2plY3QuaW5kZXguaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJQcm9qZWN0Q29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2plY3QuY3JlYXRlJywge1xuICAgICAgdXJsOiBcIi9jcmVhdGVcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3Byb2plY3QvcHJvamVjdC5lZGl0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiUHJvamVjdENyZWF0ZUNvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9qZWN0LmVkaXQnLCB7XG4gICAgICB1cmw6IFwiLzppZC9lZGl0XCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9wcm9qZWN0L3Byb2plY3QuZWRpdC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlByb2plY3RFZGl0Q29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2plY3Qtc2VjdGlvbicsIHtcbiAgICAgIHVybDogXCIvcHJvamVjdC86aWQvc2VjdGlvblwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvcHJvamVjdC9wcm9qZWN0LnNlY3Rpb24uaW5kZXguaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJQcm9qZWN0U2VjdGlvbkNvbnRyb2xsZXJcIlxuICAgIH0pXG4gICAgLnN0YXRlKCdzZWN0aW9uLWVkaXQnLCB7XG4gICAgICB1cmw6IFwiL3NlY3Rpb24vOmlkL2VkaXRcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3NlY3Rpb24vc2VjdGlvbi5lZGl0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiU2VjdGlvbkVkaXRDb250cm9sbGVyXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgndGFnJywge1xuICAgICAgdXJsOiBcIi90YWdcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3RhZy90YWcuaHRtbFwiLFxuICAgIH0pXG4gICAgLnN0YXRlKCd0YWcuaW5kZXgnLCB7XG4gICAgICB1cmw6IFwiL2luZGV4XCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy90YWcvdGFnLmluZGV4Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiVGFnQ29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3RhZy5jcmVhdGUnLCB7XG4gICAgICB1cmw6IFwiL2NyZWF0ZVwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvdGFnL3RhZy5lZGl0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiVGFnQ3JlYXRlQ29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3RhZy5lZGl0Jywge1xuICAgICAgdXJsOiBcIi86aWQvZWRpdFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvdGFnL3RhZy5lZGl0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiVGFnRWRpdENvbnRyb2xsZXJcIlxuICAgIH0pO1xufSk7XG5cblxuYXBwLmNvbmZpZyhbJ21hcmtlZFByb3ZpZGVyJywgZnVuY3Rpb24obWFya2VkUHJvdmlkZXIpIHtcbiAgICBtYXJrZWRQcm92aWRlci5zZXRPcHRpb25zKHtcbiAgICAgICAgZ2ZtOiB0cnVlLFxuICAgICAgICB0YWJsZXM6IHRydWVcbiAgICB9KTtcbn1dKTtcblxuXG4vLyBTb21lIGhlbHBmdWwgZnVuY3Rpb25zIGZvciBBSkFYIHJlcXVlc3RzXG5hcHAuZmFjdG9yeSgnUmVzdGZ1bEFwaScsIGZ1bmN0aW9uICgkaHR0cCwgbm90aWZpY2F0aW9uU2VydmljZSkge1xuXG4gICAgLy8gV290IHRvIGRvIGluY2FzZSBBUEkgZmFpbHMgdG8gcmVzcG9uZCB3aXRoIDIwMFxuICAgIHZhciBjaGVja1Jlc3BvbnNlQ29kZSA9IGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICBzd2l0Y2goc3RhdHVzKSB7XG4gICAgICAgICAgICAvLyBGYWlsZWQgdmFsaWRhdGlvblxuICAgICAgICAgICAgY2FzZSA0MjI6XG5cbiAgICAgICAgICAgICAgICAvLyBDbGVhciBhbGwgZXhpc3Rpbmcgbm90aWZpY2F0aW9uc1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuY2xlYXIoKTtcblxuICAgICAgICAgICAgICAgIC8vIENvbmNhdGVuYXRlIGFsbCB0aGUgdmFsaWRhdGlvbiBlcnJvciBtZXNzYWdlc1xuICAgICAgICAgICAgICAgIHZhciBtc2cgPSBbXTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgICAgICBtc2cgPSBtc2cuY29uY2F0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbm90aWZpY2F0aW9uXG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJWYWxpZGF0aW9uIGZhaWxlZCwgcGxlYXNlIGNvcnJlY3QgdGhlIGZvbGxvd2luZyBpc3N1ZXM6XCIsICdkYW5nZXInLCBtc2cpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBVbmF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgIGNhc2UgNDAxOlxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKCdZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQnLCAnd2FybmluZycpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1MDA6XG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoJ0FQSSBlcnJvcicsICdkYW5nZXInKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTb21lIG90aGVyIHByb2JsZW0hXCIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICAvLyBSZXR1cm5zIHRoZSBzdHJpbmcgb2YgYSBwYXJ0aWN1bGFyIHJvdXRlXG4gICAgICAgIGdldFJvdXRlOiBmdW5jdGlvbihyZXNvdXJjZSwgbWV0aG9kLCBpZCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpZCA9PT0gJ3VuZGVmaW5lZCcpIHsgaWQgPSAnMCc7IH1cblxuICAgICAgICAgICAgdmFyIHByZWZpeCA9ICcvYWRtaW4vYXBpJztcblxuICAgICAgICAgICAgdmFyIHJvdXRlcyA9IHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0ICAgICA6ICB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ICAgOiBwcmVmaXggKyAnL3Byb2plY3QnLFxuICAgICAgICAgICAgICAgICAgICBzaG93ICAgIDogcHJlZml4ICsgJy9wcm9qZWN0LycgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgc3RvcmUgICA6IHByZWZpeCArICcvcHJvamVjdCcsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZSAgOiBwcmVmaXggKyAnL3Byb2plY3QvJyArIGlkLFxuICAgICAgICAgICAgICAgICAgICBkZXN0cm95IDogcHJlZml4ICsgJy9wcm9qZWN0LycgKyBpZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VjdGlvbiAgICAgOiAge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCAgIDogcHJlZml4ICsgJy9zZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgc2hvdyAgICA6IHByZWZpeCArICcvc2VjdGlvbi8nICsgaWQsXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlICAgOiBwcmVmaXggKyAnL3NlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUgIDogcHJlZml4ICsgJy9zZWN0aW9uLycgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgZGVzdHJveSA6IHByZWZpeCArICcvc2VjdGlvbi8nICsgaWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHByb2plY3RTZWN0aW9uICAgICA6ICB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3JlICAgOiBwcmVmaXggKyAnL3Byb2plY3QvJyArIGlkICsgJy9zZWN0aW9uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGFnICAgICAgICAgOiAge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCAgIDogcHJlZml4ICsgJy90YWcnLFxuICAgICAgICAgICAgICAgICAgICBzaG93ICAgIDogcHJlZml4ICsgJy90YWcvJyArIGlkLFxuICAgICAgICAgICAgICAgICAgICBzdG9yZSAgIDogcHJlZml4ICsgJy90YWcnLFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUgIDogcHJlZml4ICsgJy90YWcvJyArIGlkLFxuICAgICAgICAgICAgICAgICAgICBkZXN0cm95IDogcHJlZml4ICsgJy90YWcvJyArIGlkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIHJvdXRlc1tyZXNvdXJjZV1bbWV0aG9kXTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIERvIHNvbWUgc3R1ZmYgdXBvbiBhIHN1Y2Nlc3NmdWwgQWpheCByZXF1ZXN0XG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnJlbW92ZUJ5VHlwZSgnZGFuZ2VyJyk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gRG8gc29tZSBzdHVmZiB1cG9uIGFuIHVuc3VjY2Vzc2Z1bCBBamF4IHJlcXVlc3RcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBjaGVja1Jlc3BvbnNlQ29kZShkYXRhLCBzdGF0dXMpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuXG5hcHAuc2VydmljZSgnbm90aWZpY2F0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuXG4gICAgdmFyIG5vdGlmaWNhdGlvbnMgPSBbXTtcblxuICAgIC8vIFJldHJpZXZlIGFsbCBtZXNzYWdlc1xuICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBub3RpZmljYXRpb25zO1xuICAgIH07XG5cbiAgICAvLyBSZW1vdmUgbmV3IG5vdGlmaWNhdGlvblxuICAgIHRoaXMuYWRkID0gZnVuY3Rpb24obWVzc2FnZSwgdHlwZSwgbWVzc2FnZXMpIHtcblxuICAgICAgICAvLyBPbmx5IGFsbG93IG9uZSBzdWNjZXNzIG1lc3NhZ2UgYXQgYSB0aW1lXG4gICAgICAgIGlmICh0eXBlID09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVCeVR5cGUoJ3N1Y2Nlc3MnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBub3RpZmljYXRpb24gPSB7XG4gICAgICAgICAgICB0eXBlIDogdHlwZSxcbiAgICAgICAgICAgIG1lc3NhZ2UgOiBtZXNzYWdlLFxuICAgICAgICAgICAgbWVzc2FnZXMgOiBtZXNzYWdlcyxcbiAgICAgICAgICAgIC8vYWN0aW9uIDogYWN0aW9uXG4gICAgICAgIH07XG5cbiAgICAgICAgbm90aWZpY2F0aW9ucy5wdXNoKG5vdGlmaWNhdGlvbik7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ2FkZGVkICcgKyB0eXBlICsgJyBtZXNzYWdlJyk7XG5cbiAgICAgICAgaWYgKHR5cGUgIT0gJ2RhbmdlcicpIHtcbiAgICAgICAgICAgIC8vIFNldCB0aGUgYWxlcnQgdG8gYmUgcmVtb3ZlZCBhZnRlciBhIGRlbGF5XG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMuc3BsaWNlKG5vdGlmaWNhdGlvbnMuaW5kZXhPZihub3RpZmljYXRpb24pLCAxKTtcbiAgICAgICAgICAgICAgICAvLyRzY29wZS5hbGVydHMuc3BsaWNlKCRzY29wZS5hbGVydHMuaW5kZXhPZihhbGVydCksIDEpO1xuICAgICAgICAgICAgfSwgNjAwMCk7IC8vIG1heWJlICd9LCAzMDAwLCBmYWxzZSk7JyB0byBhdm9pZCBjYWxsaW5nIGFwcGx5XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICAvLyBSZW1vdmUgbm90aWZpY2F0aW9uIGJ5IGFycmF5IGluZGV4XG4gICAgdGhpcy5yZW1vdmVCeUluZGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlbW92aW5nIG9uZSBtZXNzYWdlOiAnICsgaW5kZXgpO1xuICAgICAgICBub3RpZmljYXRpb25zLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGFsbCBub3RpZmljYXRpb25zIG9mIHR5cGVcbiAgICB0aGlzLnJlbW92ZUJ5VHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NsZWFyaW5nICcgKyB0eXBlICsgJyBtZXNzYWdlcycpO1xuICAgICAgICBmb3IgKGk9MDsgaSA8IG5vdGlmaWNhdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChub3RpZmljYXRpb25zW2ldLnR5cGUgPT0gdHlwZSkge1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgYWxsIG5vdGlmaWNhdGlvbnNcbiAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGVhcmluZyBhbGwgbWVzc2FnZXMnKTtcbiAgICAgICAgbm90aWZpY2F0aW9ucyA9IFtdO1xuICAgIH1cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdOb3RpZmljYXRpb25Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCBub3RpZmljYXRpb25TZXJ2aWNlLCAkdGltZW91dCkge1xuXG4gICAgJHNjb3BlLm5vdGlmaWVyID0gbm90aWZpY2F0aW9uU2VydmljZTtcblxuXG4gICAgJHNjb3BlLiR3YXRjaCgnbm90aWZpZXIuZ2V0KCknLCBmdW5jdGlvbiAobm90aWZpY2F0aW9ucykge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobm90aWZpY2F0aW9ucykpIHtcbiAgICAgICAgICAgICRzY29wZS5ub3RpZmljYXRpb25zID0gbm90aWZpY2F0aW9ucztcbiAgICAgICAgfVxuICAgIH0sIHRydWUpO1xuXG5cbiAgICAkc2NvcGUuY2xvc2VOb3RpZmljYXRpb24gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnJlbW92ZUJ5SW5kZXgoaW5kZXgpO1xuICAgIH07XG5cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdEYXNoYm9hcmRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zKSB7XG5cblxuXG59KTtcblxuYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyLCBuZ1RhYmxlUGFyYW1zLCAkaHR0cCwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSkge1xuXG4gICAgLy8gSW5pdGlhbGlzZSBhbiBlbXB0eSBhcnJheSB0byBob2xkIGRhdGFcbiAgICAkc2NvcGUuZGF0YSA9IFtdO1xuXG4gICAgLy8gSW5pdGlhbGlzZSB0aGUgZGF0YSB0YWJsZVxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBuZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgcGFnZTogMSwgICAgICAgICAgICAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgY291bnQ6IDEwLCAgICAgICAgICAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnZGVzYycgICAgIC8vIGluaXRpYWwgc29ydGluZ1xuICAgICAgICB9LFxuICAgIH0sIHtcbiAgICAgICAgZmlsdGVyRGVsYXk6IDEwLFxuICAgICAgICB0b3RhbDogJHNjb3BlLmRhdGEubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbigkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdXNlIGJ1aWxkLWluIGFuZ3VsYXIgZmlsdGVyXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhID0gcGFyYW1zLmZpbHRlcigpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmRhdGEsIHBhcmFtcy5maWx0ZXIoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTtcbiAgICAgICAgICAgIHZhciBvcmRlcmVkRGF0YSA9IHBhcmFtcy5zb3J0aW5nKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdvcmRlckJ5JykoZmlsdGVyZWREYXRhLCBwYXJhbXMub3JkZXJCeSgpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhO1xuXG4gICAgICAgICAgICBwYXJhbXMudG90YWwob3JkZXJlZERhdGEubGVuZ3RoKTsgLy8gc2V0IHRvdGFsIGZvciByZWNhbGMgcGFnaW5hdGlvblxuICAgICAgICAgICAgJGRlZmVyLnJlc29sdmUob3JkZXJlZERhdGEuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gSW5pdGlhbGlzZSAobG9hZCkgZGF0YVxuICAgICRzY29wZS5pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3VwZGF0ZScsIDQpKTtcblxuICAgICAgICAkaHR0cC5nZXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgncHJvamVjdCcsICdpbmRleCcpKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuZGVsZXRlID0gZnVuY3Rpb24oaWQsIHRpdGxlKSB7XG5cbiAgICAgICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2lzaCB0byBkZWxldGUgJyArIHRpdGxlICsgJz8nKSkge1xuXG4gICAgICAgICAgICAkaHR0cC5kZWxldGUoJy9hZG1pbi9hcGkvcHJvamVjdC8nICsgaWQpLlxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJQcm9qZWN0ICdcIiArIGRhdGEudGl0bGUgKyBcIicgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIiwgJ2luZm8nKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluaXQoKTtcbiAgICAgICAgICAgICAgICB9KS5cbiAgICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuaW5pdCgpO1xuXG5cbn0pO1xuXG5cblxuYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RDcmVhdGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIFJlc3RmdWxBcGksIG5vdGlmaWNhdGlvblNlcnZpY2UpIHtcblxuICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAkc2NvcGUuY3JlYXRlID0gdHJ1ZTtcblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oYXBwbHkpIHtcblxuICAgICAgICAkaHR0cC5wb3N0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3Byb2plY3QnLCAnc3RvcmUnKSwgJHNjb3BlLmRhdGEpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJQcm9qZWN0ICdcIiArIGRhdGEudGl0bGUgKyBcIicgYWRkZWQgc3VjY2Vzc2Z1bGx5XCIsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmICghYXBwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInByb2plY3QuaW5kZXhcIiApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAkc3RhdGUuZ28oIFwicHJvamVjdC5lZGl0XCIsIHtpZDogZGF0YS5pZH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RFZGl0Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlLCBuZ1RhYmxlUGFyYW1zLCAkZmlsdGVyLCAkbW9kYWwpIHtcblxuICAgICRzY29wZS5kYXRhID0ge1xuICAgICAgICBzZWN0aW9ucyA6IFtdXG4gICAgfTtcblxuXG4gICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IG5nVGFibGVQYXJhbXMoe1xuICAgICAgICBwYWdlOiAxLCAgICAgICAgICAgIC8vIHNob3cgZmlyc3QgcGFnZVxuICAgICAgICBjb3VudDogMTAsICAgICAgICAgIC8vIGNvdW50IHBlciBwYWdlXG4gICAgICAgIHNvcnRpbmc6IHtcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQ6ICdkZXNjJyAgICAgLy8gaW5pdGlhbCBzb3J0aW5nXG4gICAgICAgIH0sXG4gICAgfSwge1xuICAgICAgICBmaWx0ZXJEZWxheTogMTAsXG4gICAgICAgIHRvdGFsOiAkc2NvcGUuZGF0YS5zZWN0aW9ucy5sZW5ndGgsIC8vIGxlbmd0aCBvZiBkYXRhXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKCRkZWZlciwgcGFyYW1zKSB7XG4gICAgICAgICAgICAvLyB1c2UgYnVpbGQtaW4gYW5ndWxhciBmaWx0ZXJcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZERhdGEgPSBwYXJhbXMuZmlsdGVyKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuZGF0YS5zZWN0aW9ucywgcGFyYW1zLmZpbHRlcigpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnNlY3Rpb25zO1xuICAgICAgICAgICAgdmFyIG9yZGVyZWREYXRhID0gcGFyYW1zLnNvcnRpbmcoKSA/XG4gICAgICAgICAgICAgICAgICAgICRmaWx0ZXIoJ29yZGVyQnknKShmaWx0ZXJlZERhdGEsIHBhcmFtcy5vcmRlckJ5KCkpIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc2VjdGlvbnM7XG5cbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChvcmRlcmVkRGF0YS5sZW5ndGgpOyAvLyBzZXQgdG90YWwgZm9yIHJlY2FsYyBwYWdpbmF0aW9uXG4gICAgICAgICAgICAkZGVmZXIucmVzb2x2ZShvcmRlcmVkRGF0YS5zbGljZSgocGFyYW1zLnBhZ2UoKSAtIDEpICogcGFyYW1zLmNvdW50KCksIHBhcmFtcy5wYWdlKCkgKiBwYXJhbXMuY291bnQoKSkpO1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgICRodHRwLmdldChSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3Nob3cnLCAkc3RhdGVQYXJhbXMuaWQpKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5zbHVnID0gJHNjb3BlLmRhdGEuc2x1ZztcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICB9KTtcblxuXG5cbiAgICAkc2NvcGUuZWRpdFNlY3Rpb24gPSBmdW5jdGlvbiAoY3JlYXRlLCBzZWN0aW9uSWQpIHtcbiAgICAgICAgc2VjdGlvbklkID0gdHlwZW9mIHNlY3Rpb25JZCAhPT0gJ3VuZGVmaW5lZCcgPyBzZWN0aW9uSWQgOiBmYWxzZTtcblxuICAgICAgICBtb2RhbERhdGEgPSB7XG4gICAgICAgICAgICAnY3JlYXRlJyA6IGNyZWF0ZSxcbiAgICAgICAgICAgICdwcm9qZWN0SWQnIDogJHNjb3BlLmRhdGEuaWQsXG4gICAgICAgICAgICAnc2VjdGlvbklkJyA6IHNlY3Rpb25JZFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnNvbGUubG9nKG1vZGFsRGF0YSk7XG5cbiAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkbW9kYWwub3Blbih7XG4gICAgICAgICAgICBhbmltYXRpb246IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NlY3Rpb25FZGl0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2VkaXRTZWN0aW9uQ29udHJvbGxlcicsXG4gICAgICAgICAgICBzaXplOiAnbGcnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgIG1vZGFsRGF0YTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RhbERhdGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWN0aW9uLCBjcmVhdGUpIHtcbiAgICAgICAgICAgIGlmIChjcmVhdGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9ucy5wdXNoKHNlY3Rpb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZGF0YS5zZWN0aW9ucywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuaWQgPT0gc2VjdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9uc1t2YWx1ZS5pZF0gPSBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuc2x1Z1dhcm5pbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5yZW1vdmVCeVR5cGUoJ3dhcm5pbmcnKTtcbiAgICAgICAgaWYgKCRzY29wZS5zbHVnICE9ICRzY29wZS5kYXRhLnNsdWcpIHtcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiWW91IGhhdmUgbW9kaWZpZWQgdGhlIHByb2plY3Qgc2x1Zy4gUGxlYXNlIGJlIGF3YXJlIHRoYXQgdGhpcyBtYXkgYnJlYWsgaHlwZXJsaW5rcyB0byB0aGlzIHByb2plY3QuXCIsICd3YXJuaW5nJyk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oYXBwbHkpIHtcbiAgICAgICAgYXBwbHkgPSB0eXBlb2YgYXBwbHkgIT09ICd1bmRlZmluZWQnID8gYXBwbHkgOiBmYWxzZTtcblxuICAgICAgICBpZiAoJHNjb3BlLnNsdWcgIT0gJHNjb3BlLmRhdGEuc2x1Zykge1xuICAgICAgICAgICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2lzaCB0byBjaGFuZ2UgdGhlIHNsdWc/JykpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHV0KGFwcGx5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEuc2x1ZyA9ICRzY29wZS5zbHVnO1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UucmVtb3ZlQnlUeXBlKCd3YXJuaW5nJyk7XG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJTbHVnIHJlc2V0XCIsICdpbmZvJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkc2NvcGUucHV0KGFwcGx5KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgJHNjb3BlLnB1dCA9IGZ1bmN0aW9uKGFwcGx5KSB7XG4gICAgICAgICRodHRwLnB1dChSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3VwZGF0ZScsICRzdGF0ZVBhcmFtcy5pZCksICRzY29wZS5kYXRhKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiUHJvamVjdCAnXCIgKyBkYXRhLnRpdGxlICsgXCInIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW107XG4gICAgICAgICAgICBpZiAoIWFwcGx5KSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInByb2plY3QuaW5kZXhcIiApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG59KTtcblxuXG5cblxuXG5hcHAuY29udHJvbGxlcignZWRpdFNlY3Rpb25Db250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRtb2RhbEluc3RhbmNlLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlLCBtb2RhbERhdGEpIHtcblxuICAgIGlmICghbW9kYWxEYXRhLmNyZWF0ZSkge1xuXG4gICAgICAgICRodHRwLmdldChSZXN0ZnVsQXBpLmdldFJvdXRlKCdzZWN0aW9uJywgJ3Nob3cnLCBtb2RhbERhdGEuc2VjdGlvbklkKSkuXG4gICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VjdGlvbiA9IGRhdGE7XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcblxuICAgIH1cblxuXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zb2xlLmxvZyhtb2RhbERhdGEucHJvamVjdElkKTtcblxuICAgICAgICBpZiAobW9kYWxEYXRhLmNyZWF0ZSl7XG5cbiAgICAgICAgICAgICRodHRwLnBvc3QoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgncHJvamVjdFNlY3Rpb24nLCAnc3RvcmUnLCBtb2RhbERhdGEucHJvamVjdElkKSwgJHNjb3BlLnNlY3Rpb24pXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJTZWN0aW9uICdcIiArIGRhdGEudGl0bGUgKyBcIicgY3JlYXRlZCBzdWNjZXNzZnVsbHlcIiwgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZShkYXRhLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgJGh0dHAucHV0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3NlY3Rpb24nLCAndXBkYXRlJywgJHNjb3BlLnNlY3Rpb24uaWQpLCAkc2NvcGUuc2VjdGlvbilcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIlNlY3Rpb24gJ1wiICsgZGF0YS50aXRsZSArIFwiJyB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW107XG4gICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKGRhdGEsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgIH07XG59KTtcblxuYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RTZWN0aW9uQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGZpbHRlciwgbmdUYWJsZVBhcmFtcywgJGh0dHAsICRyb3V0ZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24pIHtcblxuICAgICRzY29wZS5kYXRhID0gW107XG5cbiAgICAvLyBJbml0aWFsaXNlIHRoZSBkYXRhIHRhYmxlXG4gICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IG5nVGFibGVQYXJhbXMoe1xuICAgICAgICBwYWdlOiAxLCAgICAgICAgICAgIC8vIHNob3cgZmlyc3QgcGFnZVxuICAgICAgICBjb3VudDogMTAsICAgICAgICAgIC8vIGNvdW50IHBlciBwYWdlXG4gICAgICAgIHNvcnRpbmc6IHtcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6ICdkZXNjJyAgICAgLy8gaW5pdGlhbCBzb3J0aW5nXG4gICAgICAgIH0sXG4gICAgfSwge1xuICAgICAgICBmaWx0ZXJEZWxheTogMTAsXG4gICAgICAgIHRvdGFsOiAkc2NvcGUuZGF0YS5sZW5ndGgsIC8vIGxlbmd0aCBvZiBkYXRhXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKCRkZWZlciwgcGFyYW1zKSB7XG4gICAgICAgICAgICAvLyB1c2UgYnVpbGQtaW4gYW5ndWxhciBmaWx0ZXJcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZERhdGEgPSBwYXJhbXMuZmlsdGVyKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuZGF0YSwgcGFyYW1zLmZpbHRlcigpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhO1xuICAgICAgICAgICAgdmFyIG9yZGVyZWREYXRhID0gcGFyYW1zLnNvcnRpbmcoKSA/XG4gICAgICAgICAgICAgICAgICAgICRmaWx0ZXIoJ29yZGVyQnknKShmaWx0ZXJlZERhdGEsIHBhcmFtcy5vcmRlckJ5KCkpIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE7XG5cbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChvcmRlcmVkRGF0YS5sZW5ndGgpOyAvLyBzZXQgdG90YWwgZm9yIHJlY2FsYyBwYWdpbmF0aW9uXG4gICAgICAgICAgICAkZGVmZXIucmVzb2x2ZShvcmRlcmVkRGF0YS5zbGljZSgocGFyYW1zLnBhZ2UoKSAtIDEpICogcGFyYW1zLmNvdW50KCksIHBhcmFtcy5wYWdlKCkgKiBwYXJhbXMuY291bnQoKSkpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAkc2NvcGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCRyb3V0ZVBhcmFtcy5wcm9qZWN0X2lkKTtcblxuICAgICAgICAkaHR0cC5nZXQoJy9hZG1pbi9hcGkvcHJvamVjdC8nICsgJHJvdXRlUGFyYW1zLnByb2plY3RfaWQgKyAnL3NlY3Rpb24nKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuXG4gICAgICAgICAgICAvLyBQYXJzZSBJRCBmcm9tIHRleHQgdG8gaW50ZWdlclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5pZCAgPSBwYXJzZUZsb2F0KGRhdGEuaWQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcblxuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0YXR1cyk7XG4gICAgICAgICAgICBpZiAoc3RhdHVzID09IDQwMSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbe1wiTG9nZ2VkIG91dFwiIDogXCJZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQuIFJlZnJlc2ggdGhlIHBhZ2UgdG8gbG9nIGJhY2sgaW4gYWdhaW5cIn1dO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgIH07XG5cblxuICAgICRzY29wZS5kZWxldGUgPSBmdW5jdGlvbihpZCkge1xuXG4gICAgICAgICRodHRwLmRlbGV0ZSgnL2FkbWluL2FwaS9wcm9qZWN0LycgKyBpZCkuXG4gICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbml0KCk7XG4gICAgICAgICAgfSkuXG4gICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuaW5pdCgpO1xuXG59KTtcblxuXG5cbmFwcC5jb250cm9sbGVyKCdTZWN0aW9uQ3JlYXRlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRyb3V0ZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24pIHtcblxuICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hZG1pbi9hcGkvcHJvamVjdCcsICRzY29wZS5kYXRhKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCggXCIvcHJvamVjdFwiICk7XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFt7XCJMb2dnZWQgb3V0XCIgOiBcIllvdSBoYXZlIGJlZW4gbG9nZ2VkIG91dC4gUmVmcmVzaCB0aGUgcGFnZSB0byBsb2cgYmFjayBpbiBhZ2FpblwifV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG59KTtcblxuXG5hcHAuY29udHJvbGxlcignU2VjdGlvbkVkaXRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHJvdXRlLCAkcm91dGVQYXJhbXMsICRsb2NhdGlvbikge1xuXG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcblxuICAgICRodHRwLmdldCgnL2FkbWluL2FwaS9zZWN0aW9uLycgKyAkcm91dGVQYXJhbXMuaWQpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW3tcIkxvZ2dlZCBvdXRcIiA6IFwiWW91IGhhdmUgYmVlbiBsb2dnZWQgb3V0LiBSZWZyZXNoIHRoZSBwYWdlIHRvIGxvZyBiYWNrIGluIGFnYWluXCJ9XTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG5cbiAgICAkc2NvcGUuYWRkU2VjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICRzY29wZS5kYXRhLnNlY3Rpb25zLnB1c2goe30pO1xuXG4gICAgfTtcblxuICAgICRzY29wZS5kZWxldGVTZWN0aW9uID0gZnVuY3Rpb24oaW5kZXgpIHtcblxuICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgfTtcblxuXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAkaHR0cC5wdXQoJy9hZG1pbi9hcGkvc2VjdGlvbi8nICsgJHJvdXRlUGFyYW1zLmlkLCAkc2NvcGUuZGF0YSkuXG4gICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG5cblxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCBcIi9wcm9qZWN0L1wiICsgZGF0YS5hdHRhY2htZW50X2lkICsgXCIvc2VjdGlvblwiKTtcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09IDQwMSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW3tcIkxvZ2dlZCBvdXRcIiA6IFwiWW91IGhhdmUgYmVlbiBsb2dnZWQgb3V0LiBSZWZyZXNoIHRoZSBwYWdlIHRvIGxvZyBiYWNrIGluIGFnYWluXCJ9XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pO1xuYXBwLmNvbnRyb2xsZXIoJ1RhZ0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRmaWx0ZXIsIG5nVGFibGVQYXJhbXMsICRodHRwLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlKSB7XG5cbiAgICAvLyBJbml0aWFsaXNlIGFuIGVtcHR5IGFycmF5IHRvIGhvbGQgZGF0YVxuICAgICRzY29wZS5kYXRhID0gW107XG5cbiAgICAvLyBJbml0aWFsaXNlIHRoZSBkYXRhIHRhYmxlXG4gICAgJHNjb3BlLnRhYmxlUGFyYW1zID0gbmV3IG5nVGFibGVQYXJhbXMoe1xuICAgICAgICBwYWdlOiAxLCAgICAgICAgICAgIC8vIHNob3cgZmlyc3QgcGFnZVxuICAgICAgICBjb3VudDogMTAsICAgICAgICAgIC8vIGNvdW50IHBlciBwYWdlXG4gICAgICAgIHNvcnRpbmc6IHtcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQ6ICdkZXNjJyAgICAgLy8gaW5pdGlhbCBzb3J0aW5nXG4gICAgICAgIH0sXG4gICAgfSwge1xuICAgICAgICBmaWx0ZXJEZWxheTogMTAsXG4gICAgICAgIHRvdGFsOiAkc2NvcGUuZGF0YS5sZW5ndGgsIC8vIGxlbmd0aCBvZiBkYXRhXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uKCRkZWZlciwgcGFyYW1zKSB7XG4gICAgICAgICAgICAvLyB1c2UgYnVpbGQtaW4gYW5ndWxhciBmaWx0ZXJcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZERhdGEgPSBwYXJhbXMuZmlsdGVyKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuZGF0YSwgcGFyYW1zLmZpbHRlcigpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhO1xuICAgICAgICAgICAgdmFyIG9yZGVyZWREYXRhID0gcGFyYW1zLnNvcnRpbmcoKSA/XG4gICAgICAgICAgICAgICAgICAgICRmaWx0ZXIoJ29yZGVyQnknKShmaWx0ZXJlZERhdGEsIHBhcmFtcy5vcmRlckJ5KCkpIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE7XG5cbiAgICAgICAgICAgIHBhcmFtcy50b3RhbChvcmRlcmVkRGF0YS5sZW5ndGgpOyAvLyBzZXQgdG90YWwgZm9yIHJlY2FsYyBwYWdpbmF0aW9uXG4gICAgICAgICAgICAkZGVmZXIucmVzb2x2ZShvcmRlcmVkRGF0YS5zbGljZSgocGFyYW1zLnBhZ2UoKSAtIDEpICogcGFyYW1zLmNvdW50KCksIHBhcmFtcy5wYWdlKCkgKiBwYXJhbXMuY291bnQoKSkpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBJbml0aWFsaXNlIChsb2FkKSBkYXRhXG4gICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAvL2NvbnNvbGUubG9nKFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3Byb2plY3QnLCAndXBkYXRlJywgNCkpO1xuXG4gICAgICAgICRodHRwLmdldChSZXN0ZnVsQXBpLmdldFJvdXRlKCd0YWcnLCAnaW5kZXgnKSkuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMucmVsb2FkKCk7XG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgIH0pO1xuXG4gICAgfTtcblxuXG4gICAgJHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uKGlkLCB0aXRsZSkge1xuXG4gICAgICAgIGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlICcgKyB0aXRsZSArICc/JykpIHtcblxuICAgICAgICAgICAgJGh0dHAuZGVsZXRlKFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3RhZycsICdkZXN0cm95JywgaWQpKS5cbiAgICAgICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiUHJvamVjdCAnXCIgKyBkYXRhLnRpdGxlICsgXCInIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5XCIsICdpbmZvJyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbml0KCk7XG4gICAgICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmluaXQoKTtcblxuXG59KTtcblxuXG5hcHAuY29udHJvbGxlcignVGFnQ3JlYXRlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgJHN0YXRlLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IHt9O1xuXG4gICAgJHNjb3BlLmNyZWF0ZSA9IHRydWU7XG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKGFwcGx5KSB7XG5cbiAgICAgICAgJGh0dHAucG9zdChSZXN0ZnVsQXBpLmdldFJvdXRlKCd0YWcnLCAnc3RvcmUnKSwgJHNjb3BlLmRhdGEpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJUYWcgJ1wiICsgZGF0YS50aXRsZSArIFwiJyBhZGRlZCBzdWNjZXNzZnVsbHlcIiwgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKCFhcHBseSkge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oIFwidGFnLmluZGV4XCIgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInRhZy5lZGl0XCIsIHtpZDogZGF0YS5pZH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ1RhZ0VkaXRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIFJlc3RmdWxBcGksIG5vdGlmaWNhdGlvblNlcnZpY2UsIG5nVGFibGVQYXJhbXMsICRmaWx0ZXIsICRtb2RhbCkge1xuXG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcblxuICAgICRodHRwLmdldChSZXN0ZnVsQXBpLmdldFJvdXRlKCd0YWcnLCAnc2hvdycsICRzdGF0ZVBhcmFtcy5pZCkpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgIH0pO1xuXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihhcHBseSkge1xuICAgICAgICBhcHBseSA9IHR5cGVvZiBhcHBseSAhPT0gJ3VuZGVmaW5lZCcgPyBhcHBseSA6IGZhbHNlO1xuICAgICAgICAkc2NvcGUucHV0KGFwcGx5KTtcbiAgICB9XG5cbiAgICAkc2NvcGUucHV0ID0gZnVuY3Rpb24oYXBwbHkpIHtcbiAgICAgICAgJGh0dHAucHV0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3RhZycsICd1cGRhdGUnLCAkc3RhdGVQYXJhbXMuaWQpLCAkc2NvcGUuZGF0YSkuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuc3VjY2VzcyhkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIlRhZyAnXCIgKyBkYXRhLnRpdGxlICsgXCInIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW107XG4gICAgICAgICAgICBpZiAoIWFwcGx5KSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInRhZy5pbmRleFwiICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbn0pO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=