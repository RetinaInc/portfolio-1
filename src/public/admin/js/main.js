var app=angular.module("ng-portfolio",["ui.router","ui.bootstrap","ngTable"]);app.config(function($httpProvider){$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"});app.config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/dashboard");$stateProvider.state("dashboard",{url:"/dashboard",templateUrl:"/vendor/portfolio/admin/views/dashboard.html",controller:"DashboardController"}).state("project",{url:"/project",templateUrl:"/vendor/portfolio/admin/views/project/project.html"}).state("project.index",{url:"/index",templateUrl:"/vendor/portfolio/admin/views/project/project.index.html",controller:"ProjectController"}).state("project.create",{url:"/create",templateUrl:"/vendor/portfolio/admin/views/project/project.edit.html",controller:"ProjectCreateController"}).state("project.edit",{url:"/:id/edit",templateUrl:"/vendor/portfolio/admin/views/project/project.edit.html",controller:"ProjectEditController"}).state("project-section",{url:"/project/:id/section",templateUrl:"/vendor/portfolio/admin/views/project/project.section.index.html",controller:"ProjectSectionController"}).state("section-edit",{url:"/section/:id/edit",templateUrl:"/vendor/portfolio/admin/views/section/section.edit.html",controller:"SectionEditController"})});app.factory("RestfulApi",function($http,notificationService){var checkResponseCode=function(data,status){switch(status){case 422:notificationService.clear();var msg=[];angular.forEach(data,function(value,key){msg=msg.concat(value)});notificationService.add("Validation failed, please correct the following issues:","danger",msg);break;case 401:notificationService.add("You have been logged out","warning");break;case 500:notificationService.add("API error","danger");break;default:console.log("Some other problem!");console.log(data)}};return{getRoute:function(resource,method,id){if(typeof id==="undefined"){id="0"}var prefix="/admin/api";var routes={project:{index:prefix+"/project",show:prefix+"/project/"+id,store:prefix+"/project",update:prefix+"/project/"+id,destroy:prefix+"/project/"+id},section:{index:prefix+"/section",show:prefix+"/section/"+id,store:prefix+"/section",update:prefix+"/section/"+id,destroy:prefix+"/section/"+id}};return routes[resource][method]},success:function(data,status,headers,config){notificationService.removeByType("danger");return data},error:function(data,status,headers,config){checkResponseCode(data,status);return data}}});app.service("notificationService",function($timeout){var notifications=[];this.get=function(){return notifications};this.add=function(message,type,messages){if(type=="success"){this.removeByType("success")}var notification={type:type,message:message,messages:messages};notifications.push(notification);console.log("added "+type+" message");if(type!="danger"){$timeout(function(){notifications.splice(notifications.indexOf(notification),1)},6e3)}};this.removeByIndex=function(index){console.log("removing one message: "+index);notifications.splice(index,1)};this.removeByType=function(type){console.log("clearing "+type+" messages");for(i=0;i<notifications.length;i++){if(notifications[i].type==type){notifications.splice(i,1)}}};this.clear=function(){console.log("clearing all messages");notifications=[]}});app.controller("NotificationController",function($scope,notificationService,$timeout){$scope.notifier=notificationService;$scope.$watch("notifier.get()",function(notifications){if(angular.isDefined(notifications)){$scope.notifications=notifications}},true);$scope.closeNotification=function(index){notificationService.removeByIndex(index)}});app.controller("DashboardController",function($scope,$http,$stateParams){});app.controller("ProjectController",function($scope,$filter,ngTableParams,$http,RestfulApi,notificationService){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){$http.get(RestfulApi.getRoute("project","index")).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config)})};$scope.delete=function(id,title){if(confirm("Are you sure you wish to delete "+title+"?")){$http.delete("/admin/api/project/"+id).success(function(data,status,headers,config){notificationService.add("Project '"+data.title+"' deleted successfully","info");$scope.init()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}};$scope.init()});app.controller("ProjectCreateController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService){$scope.data={};$scope.save=function(apply){$http.post(RestfulApi.getRoute("project","store"),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Project '"+data.title+"' added successfully","success");$scope.errors=[];if(!apply){$state.go("project.index")}else{$state.go("project.edit",{id:data.id})}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("ProjectEditController",function($scope,$http,$stateParams,$state,RestfulApi,notificationService,ngTableParams,$filter,$modal){$scope.data={sections:[]};$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{updated_at:"desc"}},{filterDelay:10,total:$scope.data.sections.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data.sections,params.filter()):$scope.data.sections;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data.sections;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$http.get(RestfulApi.getRoute("project","show",$stateParams.id)).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);$scope.data=data;$scope.slug=$scope.data.slug;$scope.tableParams.reload()}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data});$scope.editSection=function(sectionIndex){var modalInstance=$modal.open({animation:$scope.animationsEnabled,templateUrl:"sectionEdit.html",controller:"editSectionController",size:"md",resolve:{section:function(){return $scope.data.sections[sectionIndex]}}})};$scope.toggleAnimation=function(){$scope.animationsEnabled=!$scope.animationsEnabled};$scope.slugWarning=function(){notificationService.removeByType("warning");if($scope.slug!=$scope.data.slug){notificationService.add("You have modified the project slug. Please be aware that this may break hyperlinks to this project.","warning")}};$scope.save=function(apply){apply=typeof apply!=="undefined"?apply:false;if($scope.slug!=$scope.data.slug){if(confirm("Are you sure you wish to change the slug?")){$scope.put(apply)}else{$scope.data.slug=$scope.slug;notificationService.removeByType("warning");notificationService.add("Slug reset","info")}}else{$scope.put(apply)}};$scope.put=function(apply){$http.put(RestfulApi.getRoute("project","update",$stateParams.id),$scope.data).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Project '"+data.title+"' updated successfully","success");$scope.errors=[];if(!apply){$state.go("project.index")}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})}});app.controller("editSectionController",function($scope,$http,$modalInstance,RestfulApi,notificationService,section){$scope.section=section;$scope.save=function(apply){$http.put(RestfulApi.getRoute("section","update",$scope.section.id),$scope.section).success(function(data,status,headers,config){RestfulApi.success(data,status,headers,config);notificationService.add("Section '"+data.title+"' updated successfully","success");$scope.errors=[];if(!apply){$modalInstance.close()}}).error(function(data,status,headers,config){RestfulApi.error(data,status,headers,config);$scope.errors=data})};$scope.cancel=function(){$modalInstance.dismiss("cancel")}});app.controller("ProjectSectionController",function($scope,$filter,ngTableParams,$http,$route,$routeParams,$location){$scope.data=[];$scope.tableParams=new ngTableParams({page:1,count:10,sorting:{created_at:"desc"}},{filterDelay:10,total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data;var orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length);$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}});$scope.init=function(){console.log($routeParams.project_id);$http.get("/admin/api/project/"+$routeParams.project_id+"/section").success(function(data,status,headers,config){$scope.data=data;angular.forEach(data,function(data){data.id=parseFloat(data.id)});$scope.tableParams.reload()}).error(function(data,status,headers,config){console.log(status);if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})};$scope.delete=function(id){$http.delete("/admin/api/project/"+id).success(function(data,status,headers,config){$scope.init()}).error(function(data,status,headers,config){$scope.errors=data})};$scope.init()});app.controller("SectionCreateController",function($scope,$http,$route,$routeParams,$location){$scope.data={};$scope.save=function(){$http.post("/admin/api/project",$scope.data).success(function(data,status,headers,config){$location.path("/project")}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})}});app.controller("SectionEditController",function($scope,$http,$route,$routeParams,$location){$scope.data={};$http.get("/admin/api/section/"+$routeParams.id).success(function(data,status,headers,config){$scope.data=data}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}});$scope.addSection=function(){$scope.data.sections.push({})};$scope.deleteSection=function(index){$scope.data.sections.splice(index,1)};$scope.save=function(){$http.put("/admin/api/section/"+$routeParams.id,$scope.data).success(function(data,status,headers,config){$location.path("/project/"+data.attachment_id+"/section")}).error(function(data,status,headers,config){if(status==401){$scope.errors=[{"Logged out":"You have been logged out. Refresh the page to log back in again"}]}else{$scope.errors=data}})}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9wdWJsaWMvYWRtaW4vanMvbWFpbi5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJmYWN0b3J5IiwiJGh0dHAiLCJub3RpZmljYXRpb25TZXJ2aWNlIiwiY2hlY2tSZXNwb25zZUNvZGUiLCJkYXRhIiwic3RhdHVzIiwiY2xlYXIiLCJtc2ciLCJmb3JFYWNoIiwidmFsdWUiLCJrZXkiLCJjb25jYXQiLCJhZGQiLCJjb25zb2xlIiwibG9nIiwiZ2V0Um91dGUiLCJyZXNvdXJjZSIsIm1ldGhvZCIsImlkIiwicHJlZml4Iiwicm91dGVzIiwicHJvamVjdCIsImluZGV4Iiwic2hvdyIsInN0b3JlIiwidXBkYXRlIiwiZGVzdHJveSIsInNlY3Rpb24iLCJzdWNjZXNzIiwicmVtb3ZlQnlUeXBlIiwiZXJyb3IiLCJzZXJ2aWNlIiwiJHRpbWVvdXQiLCJub3RpZmljYXRpb25zIiwidGhpcyIsImdldCIsIm1lc3NhZ2UiLCJ0eXBlIiwibWVzc2FnZXMiLCJub3RpZmljYXRpb24iLCJwdXNoIiwic3BsaWNlIiwiaW5kZXhPZiIsInJlbW92ZUJ5SW5kZXgiLCJpIiwibGVuZ3RoIiwiJHNjb3BlIiwibm90aWZpZXIiLCIkd2F0Y2giLCJpc0RlZmluZWQiLCJjbG9zZU5vdGlmaWNhdGlvbiIsIiRzdGF0ZVBhcmFtcyIsIiRmaWx0ZXIiLCJuZ1RhYmxlUGFyYW1zIiwiUmVzdGZ1bEFwaSIsInRhYmxlUGFyYW1zIiwicGFnZSIsImNvdW50Iiwic29ydGluZyIsInVwZGF0ZWRfYXQiLCJmaWx0ZXJEZWxheSIsInRvdGFsIiwiZ2V0RGF0YSIsIiRkZWZlciIsInBhcmFtcyIsImZpbHRlcmVkRGF0YSIsImZpbHRlciIsIm9yZGVyZWREYXRhIiwib3JkZXJCeSIsInJlc29sdmUiLCJzbGljZSIsImluaXQiLCJyZWxvYWQiLCJkZWxldGUiLCJ0aXRsZSIsImNvbmZpcm0iLCJlcnJvcnMiLCIkc3RhdGUiLCJzYXZlIiwiYXBwbHkiLCJwb3N0IiwiZ28iLCIkbW9kYWwiLCJzZWN0aW9ucyIsInNsdWciLCJlZGl0U2VjdGlvbiIsInNlY3Rpb25JbmRleCIsIm1vZGFsSW5zdGFuY2UiLCJvcGVuIiwiYW5pbWF0aW9uIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJzaXplIiwidG9nZ2xlQW5pbWF0aW9uIiwic2x1Z1dhcm5pbmciLCJwdXQiLCIkbW9kYWxJbnN0YW5jZSIsImNsb3NlIiwiY2FuY2VsIiwiZGlzbWlzcyIsIiRyb3V0ZSIsIiRyb3V0ZVBhcmFtcyIsIiRsb2NhdGlvbiIsImNyZWF0ZWRfYXQiLCJwcm9qZWN0X2lkIiwicGFyc2VGbG9hdCIsIkxvZ2dlZCBvdXQiLCJwYXRoIiwiYWRkU2VjdGlvbiIsImRlbGV0ZVNlY3Rpb24iLCJhdHRhY2htZW50X2lkIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSxLQUFNQyxRQUFRQyxPQUFPLGdCQUFpQixZQUFhLGVBQWdCLFdBVXZFRixLQUFJRyxPQUFPLFNBQVNDLGVBRWhCQSxjQUFjQyxTQUFTQyxRQUFRQyxPQUFPLG9CQUFzQixrQkFLaEVQLEtBQUlHLE9BQU8sU0FBU0ssZUFBZ0JDLG9CQUdsQ0EsbUJBQW1CQyxVQUFVLGFBSzdCRixnQkFDR0csTUFBTSxhQUNMQyxJQUFLLGFBQ0xDLFlBQWEsK0NBQ2JDLFdBQVksd0JBRWJILE1BQU0sV0FDTEMsSUFBSyxXQUNMQyxZQUFhLHVEQUVkRixNQUFNLGlCQUNMQyxJQUFLLFNBQ0xDLFlBQWEsMkRBQ2JDLFdBQVksc0JBRWJILE1BQU0sa0JBQ0xDLElBQUssVUFDTEMsWUFBYSwwREFDYkMsV0FBWSw0QkFFYkgsTUFBTSxnQkFDTEMsSUFBSyxZQUNMQyxZQUFhLDBEQUNiQyxXQUFZLDBCQUViSCxNQUFNLG1CQUNMQyxJQUFLLHVCQUNMQyxZQUFhLG1FQUNiQyxXQUFZLDZCQUViSCxNQUFNLGdCQUNMQyxJQUFLLG9CQUNMQyxZQUFhLDBEQUNiQyxXQUFZLDJCQU1sQmQsS0FBSWUsUUFBUSxhQUFjLFNBQVVDLE1BQU9DLHFCQUd2QyxHQUFJQyxtQkFBb0IsU0FBU0MsS0FBTUMsUUFDbkMsT0FBT0EsUUFFSCxJQUFLLEtBR0RILG9CQUFvQkksT0FHcEIsSUFBSUMsT0FDSnJCLFNBQVFzQixRQUFRSixLQUFNLFNBQVNLLE1BQU9DLEtBQ2xDSCxJQUFNQSxJQUFJSSxPQUFPRixRQUlyQlAscUJBQW9CVSxJQUFJLDBEQUEyRCxTQUFVTCxJQUM3RixNQUdKLEtBQUssS0FDREwsb0JBQW9CVSxJQUFJLDJCQUE0QixVQUNwRCxNQUNKLEtBQUssS0FDRFYsb0JBQW9CVSxJQUFJLFlBQWEsU0FDckMsTUFDSixTQUNJQyxRQUFRQyxJQUFJLHNCQUNaRCxTQUFRQyxJQUFJVixPQUl4QixRQUdJVyxTQUFVLFNBQVNDLFNBQVVDLE9BQVFDLElBQ2pDLFNBQVdBLE1BQU8sWUFBYSxDQUFFQSxHQUFLLElBRXRDLEdBQUlDLFFBQVMsWUFFYixJQUFJQyxTQUNBQyxTQUNJQyxNQUFVSCxPQUFTLFdBQ25CSSxLQUFVSixPQUFTLFlBQWNELEdBQ2pDTSxNQUFVTCxPQUFTLFdBQ25CTSxPQUFVTixPQUFTLFlBQWNELEdBQ2pDUSxRQUFVUCxPQUFTLFlBQWNELElBRXJDUyxTQUNJTCxNQUFVSCxPQUFTLFdBQ25CSSxLQUFVSixPQUFTLFlBQWNELEdBQ2pDTSxNQUFVTCxPQUFTLFdBQ25CTSxPQUFVTixPQUFTLFlBQWNELEdBQ2pDUSxRQUFVUCxPQUFTLFlBQWNELElBSXpDLE9BQU9FLFFBQU9KLFVBQVVDLFNBSzVCVyxRQUFTLFNBQVN4QixLQUFNQyxPQUFRZCxRQUFTSCxRQUNyQ2Msb0JBQW9CMkIsYUFBYSxTQUNqQyxPQUFPekIsT0FHWDBCLE1BQU8sU0FBUzFCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ25DZSxrQkFBa0JDLEtBQU1DLE9BQ3hCLE9BQU9ELFNBTW5CbkIsS0FBSThDLFFBQVEsc0JBQXVCLFNBQVVDLFVBRXpDLEdBQUlDLGlCQUdKQyxNQUFLQyxJQUFNLFdBQ1AsTUFBT0YsZUFJWEMsTUFBS3RCLElBQU0sU0FBU3dCLFFBQVNDLEtBQU1DLFVBRy9CLEdBQUlELE1BQVEsVUFBVyxDQUNuQkgsS0FBS0wsYUFBYSxXQUd0QixHQUFJVSxlQUNBRixLQUFPQSxLQUNQRCxRQUFVQSxRQUNWRSxTQUFXQSxTQUlmTCxlQUFjTyxLQUFLRCxhQUVuQjFCLFNBQVFDLElBQUksU0FBV3VCLEtBQU8sV0FFOUIsSUFBSUEsTUFBUSxTQUFVLENBRWxCTCxTQUFTLFdBQ0xDLGNBQWNRLE9BQU9SLGNBQWNTLFFBQVFILGNBQWUsSUFFM0QsTUFNWEwsTUFBS1MsY0FBZ0IsU0FBU3JCLE9BQzFCVCxRQUFRQyxJQUFJLHlCQUEyQlEsTUFDdkNXLGVBQWNRLE9BQU9uQixNQUFPLEdBSWhDWSxNQUFLTCxhQUFlLFNBQVNRLE1BQ3pCeEIsUUFBUUMsSUFBSSxZQUFjdUIsS0FBTyxZQUNqQyxLQUFLTyxFQUFFLEVBQUdBLEVBQUlYLGNBQWNZLE9BQVFELElBQUssQ0FDckMsR0FBSVgsY0FBY1csR0FBR1AsTUFBUUEsS0FBTSxDQUMvQkosY0FBY1EsT0FBT0csRUFBRyxLQU1wQ1YsTUFBSzVCLE1BQVEsV0FDVE8sUUFBUUMsSUFBSSx3QkFDWm1CLG9CQUtSaEQsS0FBSWMsV0FBVyx5QkFBMEIsU0FBUytDLE9BQVE1QyxvQkFBcUI4QixVQUUzRWMsT0FBT0MsU0FBVzdDLG1CQUdsQjRDLFFBQU9FLE9BQU8saUJBQWtCLFNBQVVmLGVBQ3RDLEdBQUkvQyxRQUFRK0QsVUFBVWhCLGVBQWdCLENBQ2xDYSxPQUFPYixjQUFnQkEsZ0JBRTVCLEtBR0hhLFFBQU9JLGtCQUFvQixTQUFTNUIsT0FDaENwQixvQkFBb0J5QyxjQUFjckIsU0FNMUNyQyxLQUFJYyxXQUFXLHNCQUF1QixTQUFTK0MsT0FBUTdDLE1BQU9rRCxnQkFNOURsRSxLQUFJYyxXQUFXLG9CQUFxQixTQUFTK0MsT0FBUU0sUUFBU0MsY0FBZXBELE1BQU9xRCxXQUFZcEQscUJBRzVGNEMsT0FBTzFDLE9BR1AwQyxRQUFPUyxZQUFjLEdBQUlGLGdCQUNyQkcsS0FBTSxFQUNOQyxNQUFPLEdBQ1BDLFNBQ0lDLFdBQVksVUFHaEJDLFlBQWEsR0FDYkMsTUFBT2YsT0FBTzFDLEtBQUt5QyxPQUNuQmlCLFFBQVMsU0FBU0MsT0FBUUMsUUFFdEIsR0FBSUMsY0FBZUQsT0FBT0UsU0FDbEJkLFFBQVEsVUFBVU4sT0FBTzFDLEtBQU00RCxPQUFPRSxVQUN0Q3BCLE9BQU8xQyxJQUNmLElBQUkrRCxhQUFjSCxPQUFPTixVQUNqQk4sUUFBUSxXQUFXYSxhQUFjRCxPQUFPSSxXQUN4Q3RCLE9BQU8xQyxJQUVmNEQsUUFBT0gsTUFBTU0sWUFBWXRCLE9BQ3pCa0IsUUFBT00sUUFBUUYsWUFBWUcsT0FBT04sT0FBT1IsT0FBUyxHQUFLUSxPQUFPUCxRQUFTTyxPQUFPUixPQUFTUSxPQUFPUCxZQUt0R1gsUUFBT3lCLEtBQU8sV0FJVnRFLE1BQU1rQyxJQUFJbUIsV0FBV3ZDLFNBQVMsVUFBVyxVQUN6Q2EsUUFBUSxTQUFTeEIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDcENrRSxXQUFXMUIsUUFBUXhCLEtBQU1DLE9BQVFkLFFBQVNILE9BQzFDMEQsUUFBTzFDLEtBQU9BLElBQ2QwQyxRQUFPUyxZQUFZaUIsV0FFdkIxQyxNQUFNLFNBQVMxQixLQUFNQyxPQUFRZCxRQUFTSCxRQUNsQ2tFLFdBQVd4QixNQUFNMUIsS0FBTUMsT0FBUWQsUUFBU0gsVUFNaEQwRCxRQUFPMkIsT0FBUyxTQUFTdkQsR0FBSXdELE9BRXpCLEdBQUlDLFFBQVEsbUNBQXFDRCxNQUFRLEtBQU0sQ0FFM0R6RSxNQUFNd0UsT0FBTyxzQkFBd0J2RCxJQUNqQ1UsUUFBUSxTQUFTeEIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDcENjLG9CQUFvQlUsSUFBSSxZQUFjUixLQUFLc0UsTUFBUSx5QkFBMEIsT0FDN0U1QixRQUFPeUIsU0FFWHpDLE1BQU0sU0FBUzFCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ2xDa0UsV0FBV3hCLE1BQU0xQixLQUFNQyxPQUFRZCxRQUFTSCxPQUN4QzBELFFBQU84QixPQUFTeEUsUUFLaEMwQyxRQUFPeUIsUUFPWHRGLEtBQUljLFdBQVcsMEJBQTJCLFNBQVMrQyxPQUFRN0MsTUFBT2tELGFBQWMwQixPQUFRdkIsV0FBWXBELHFCQUVoRzRDLE9BQU8xQyxPQUVQMEMsUUFBT2dDLEtBQU8sU0FBU0MsT0FFbkI5RSxNQUFNK0UsS0FBSzFCLFdBQVd2QyxTQUFTLFVBQVcsU0FBVStCLE9BQU8xQyxNQUN2RHdCLFFBQVEsU0FBU3hCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ3BDa0UsV0FBVzFCLFFBQVF4QixLQUFNQyxPQUFRZCxRQUFTSCxPQUMxQ2MscUJBQW9CVSxJQUFJLFlBQWNSLEtBQUtzRSxNQUFRLHVCQUF3QixVQUMzRTVCLFFBQU84QixTQUNQLEtBQUtHLE1BQU8sQ0FDUkYsT0FBT0ksR0FBSSxxQkFDUixDQUNOSixPQUFPSSxHQUFJLGdCQUFpQi9ELEdBQUlkLEtBQUtjLFFBRzFDWSxNQUFNLFNBQVMxQixLQUFNQyxPQUFRZCxRQUFTSCxRQUNsQ2tFLFdBQVd4QixNQUFNMUIsS0FBTUMsT0FBUWQsUUFBU0gsT0FDeEMwRCxRQUFPOEIsT0FBU3hFLFNBT2hDbkIsS0FBSWMsV0FBVyx3QkFBeUIsU0FBUytDLE9BQVE3QyxNQUFPa0QsYUFBYzBCLE9BQVF2QixXQUFZcEQsb0JBQXFCbUQsY0FBZUQsUUFBUzhCLFFBRTNJcEMsT0FBTzFDLE1BQ0grRSxZQUlKckMsUUFBT1MsWUFBYyxHQUFJRixnQkFDckJHLEtBQU0sRUFDTkMsTUFBTyxHQUNQQyxTQUNJQyxXQUFZLFVBR2hCQyxZQUFhLEdBQ2JDLE1BQU9mLE9BQU8xQyxLQUFLK0UsU0FBU3RDLE9BQzVCaUIsUUFBUyxTQUFTQyxPQUFRQyxRQUV0QixHQUFJQyxjQUFlRCxPQUFPRSxTQUNsQmQsUUFBUSxVQUFVTixPQUFPMUMsS0FBSytFLFNBQVVuQixPQUFPRSxVQUMvQ3BCLE9BQU8xQyxLQUFLK0UsUUFDcEIsSUFBSWhCLGFBQWNILE9BQU9OLFVBQ2pCTixRQUFRLFdBQVdhLGFBQWNELE9BQU9JLFdBQ3hDdEIsT0FBTzFDLEtBQUsrRSxRQUVwQm5CLFFBQU9ILE1BQU1NLFlBQVl0QixPQUN6QmtCLFFBQU9NLFFBQVFGLFlBQVlHLE9BQU9OLE9BQU9SLE9BQVMsR0FBS1EsT0FBT1AsUUFBU08sT0FBT1IsT0FBU1EsT0FBT1AsWUFPdEd4RCxPQUFNa0MsSUFBSW1CLFdBQVd2QyxTQUFTLFVBQVcsT0FBUW9DLGFBQWFqQyxLQUMxRFUsUUFBUSxTQUFTeEIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDcENrRSxXQUFXMUIsUUFBUXhCLEtBQU1DLE9BQVFkLFFBQVNILE9BQzFDMEQsUUFBTzFDLEtBQU9BLElBQ2QwQyxRQUFPc0MsS0FBT3RDLE9BQU8xQyxLQUFLZ0YsSUFDMUJ0QyxRQUFPUyxZQUFZaUIsV0FFdkIxQyxNQUFNLFNBQVMxQixLQUFNQyxPQUFRZCxRQUFTSCxRQUNsQ2tFLFdBQVd4QixNQUFNMUIsS0FBTUMsT0FBUWQsUUFBU0gsT0FDeEMwRCxRQUFPOEIsT0FBU3hFLE1BbUI1QjBDLFFBQU91QyxZQUFjLFNBQVVDLGNBRTNCLEdBQUlDLGVBQWdCTCxPQUFPTSxNQUN6QkMsVUFBVzNDLE9BQU80QyxrQkFDbEI1RixZQUFhLG1CQUNiQyxXQUFZLHdCQUNaNEYsS0FBTSxLQUNOdEIsU0FDRTFDLFFBQVMsV0FDUCxNQUFPbUIsUUFBTzFDLEtBQUsrRSxTQUFTRyxrQkFjcEN4QyxRQUFPOEMsZ0JBQWtCLFdBQ3ZCOUMsT0FBTzRDLG1CQUFxQjVDLE9BQU80QyxrQkFNbkM1QyxRQUFPK0MsWUFBYyxXQUNqQjNGLG9CQUFvQjJCLGFBQWEsVUFDakMsSUFBSWlCLE9BQU9zQyxNQUFRdEMsT0FBTzFDLEtBQUtnRixLQUFNLENBQ2pDbEYsb0JBQW9CVSxJQUFJLHNHQUF1RyxZQUt2SWtDLFFBQU9nQyxLQUFPLFNBQVNDLE9BQ25CQSxZQUFlQSxTQUFVLFlBQWNBLE1BQVEsS0FFL0MsSUFBSWpDLE9BQU9zQyxNQUFRdEMsT0FBTzFDLEtBQUtnRixLQUFNLENBQ2pDLEdBQUlULFFBQVEsNkNBQThDLENBQ3REN0IsT0FBT2dELElBQUlmLFdBQ1IsQ0FDSGpDLE9BQU8xQyxLQUFLZ0YsS0FBT3RDLE9BQU9zQyxJQUMxQmxGLHFCQUFvQjJCLGFBQWEsVUFDakMzQixxQkFBb0JVLElBQUksYUFBYyxhQUV2QyxDQUNIa0MsT0FBT2dELElBQUlmLFFBS25CakMsUUFBT2dELElBQU0sU0FBU2YsT0FDZDlFLE1BQU02RixJQUFJeEMsV0FBV3ZDLFNBQVMsVUFBVyxTQUFVb0MsYUFBYWpDLElBQUs0QixPQUFPMUMsTUFDNUV3QixRQUFRLFNBQVN4QixLQUFNQyxPQUFRZCxRQUFTSCxRQUNwQ2tFLFdBQVcxQixRQUFReEIsS0FBTUMsT0FBUWQsUUFBU0gsT0FDMUNjLHFCQUFvQlUsSUFBSSxZQUFjUixLQUFLc0UsTUFBUSx5QkFBMEIsVUFDN0U1QixRQUFPOEIsU0FDUCxLQUFLRyxNQUFPLENBQ1JGLE9BQU9JLEdBQUksb0JBR25CbkQsTUFBTSxTQUFTMUIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDbENrRSxXQUFXeEIsTUFBTTFCLEtBQU1DLE9BQVFkLFFBQVNILE9BQ3hDMEQsUUFBTzhCLE9BQVN4RSxTQVdoQ25CLEtBQUljLFdBQVcsd0JBQXlCLFNBQVUrQyxPQUFRN0MsTUFBTzhGLGVBQWdCekMsV0FBWXBELG9CQUFxQnlCLFNBRTlHbUIsT0FBT25CLFFBQVVBLE9BRWpCbUIsUUFBT2dDLEtBQU8sU0FBU0MsT0FFbkI5RSxNQUFNNkYsSUFBSXhDLFdBQVd2QyxTQUFTLFVBQVcsU0FBVStCLE9BQU9uQixRQUFRVCxJQUFLNEIsT0FBT25CLFNBQ3pFQyxRQUFRLFNBQVN4QixLQUFNQyxPQUFRZCxRQUFTSCxRQUNyQ2tFLFdBQVcxQixRQUFReEIsS0FBTUMsT0FBUWQsUUFBU0gsT0FDMUNjLHFCQUFvQlUsSUFBSSxZQUFjUixLQUFLc0UsTUFBUSx5QkFBMEIsVUFDN0U1QixRQUFPOEIsU0FDUCxLQUFLRyxNQUFPLENBQ1JnQixlQUFlQyxXQUd0QmxFLE1BQU0sU0FBUzFCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ25Da0UsV0FBV3hCLE1BQU0xQixLQUFNQyxPQUFRZCxRQUFTSCxPQUN4QzBELFFBQU84QixPQUFTeEUsT0FLNUIwQyxRQUFPbUQsT0FBUyxXQUNaRixlQUFlRyxRQUFRLFlBSS9CakgsS0FBSWMsV0FBVywyQkFBNEIsU0FBUytDLE9BQVFNLFFBQVNDLGNBQWVwRCxNQUFPa0csT0FBUUMsYUFBY0MsV0FFN0d2RCxPQUFPMUMsT0FHUDBDLFFBQU9TLFlBQWMsR0FBSUYsZ0JBQ3JCRyxLQUFNLEVBQ05DLE1BQU8sR0FDUEMsU0FDSTRDLFdBQVksVUFHaEIxQyxZQUFhLEdBQ2JDLE1BQU9mLE9BQU8xQyxLQUFLeUMsT0FDbkJpQixRQUFTLFNBQVNDLE9BQVFDLFFBRXRCLEdBQUlDLGNBQWVELE9BQU9FLFNBQ2xCZCxRQUFRLFVBQVVOLE9BQU8xQyxLQUFNNEQsT0FBT0UsVUFDdENwQixPQUFPMUMsSUFDZixJQUFJK0QsYUFBY0gsT0FBT04sVUFDakJOLFFBQVEsV0FBV2EsYUFBY0QsT0FBT0ksV0FDeEN0QixPQUFPMUMsSUFFZjRELFFBQU9ILE1BQU1NLFlBQVl0QixPQUN6QmtCLFFBQU9NLFFBQVFGLFlBQVlHLE9BQU9OLE9BQU9SLE9BQVMsR0FBS1EsT0FBT1AsUUFBU08sT0FBT1IsT0FBU1EsT0FBT1AsWUFJdEdYLFFBQU95QixLQUFPLFdBRVYxRCxRQUFRQyxJQUFJc0YsYUFBYUcsV0FFekJ0RyxPQUFNa0MsSUFBSSxzQkFBd0JpRSxhQUFhRyxXQUFhLFlBQzVEM0UsUUFBUSxTQUFTeEIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDcEMwRCxPQUFPMUMsS0FBT0EsSUFHZGxCLFNBQVFzQixRQUFRSixLQUFNLFNBQVVBLE1BQzVCQSxLQUFLYyxHQUFNc0YsV0FBV3BHLEtBQUtjLEtBRy9CNEIsUUFBT1MsWUFBWWlCLFdBR3ZCMUMsTUFBTSxTQUFTMUIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDbEN5QixRQUFRQyxJQUFJVCxPQUNaLElBQUlBLFFBQVUsSUFBSyxDQUNmeUMsT0FBTzhCLFNBQVc2QixhQUFlLHdFQUM5QixDQUNIM0QsT0FBTzhCLE9BQVN4RSxRQVE1QjBDLFFBQU8yQixPQUFTLFNBQVN2RCxJQUVyQmpCLE1BQU13RSxPQUFPLHNCQUF3QnZELElBQ25DVSxRQUFRLFNBQVN4QixLQUFNQyxPQUFRZCxRQUFTSCxRQUNsQzBELE9BQU95QixTQUViekMsTUFBTSxTQUFTMUIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDaEMwRCxPQUFPOEIsT0FBU3hFLE9BSTVCMEMsUUFBT3lCLFFBTVh0RixLQUFJYyxXQUFXLDBCQUEyQixTQUFTK0MsT0FBUTdDLE1BQU9rRyxPQUFRQyxhQUFjQyxXQUVwRnZELE9BQU8xQyxPQUVQMEMsUUFBT2dDLEtBQU8sV0FFVjdFLE1BQU0rRSxLQUFLLHFCQUFzQmxDLE9BQU8xQyxNQUNwQ3dCLFFBQVEsU0FBU3hCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ3BDaUgsVUFBVUssS0FBTSxjQUVwQjVFLE1BQU0sU0FBUzFCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ2xDLEdBQUlpQixRQUFVLElBQUssQ0FDZnlDLE9BQU84QixTQUFXNkIsYUFBZSx3RUFDOUIsQ0FDSDNELE9BQU84QixPQUFTeEUsVUFRcENuQixLQUFJYyxXQUFXLHdCQUF5QixTQUFTK0MsT0FBUTdDLE1BQU9rRyxPQUFRQyxhQUFjQyxXQUVsRnZELE9BQU8xQyxPQUVQSCxPQUFNa0MsSUFBSSxzQkFBd0JpRSxhQUFhbEYsSUFDM0NVLFFBQVEsU0FBU3hCLEtBQU1DLE9BQVFkLFFBQVNILFFBQ3BDMEQsT0FBTzFDLEtBQU9BLE9BRWxCMEIsTUFBTSxTQUFTMUIsS0FBTUMsT0FBUWQsUUFBU0gsUUFDbEMsR0FBSWlCLFFBQVUsSUFBSyxDQUNmeUMsT0FBTzhCLFNBQVc2QixhQUFlLHdFQUM5QixDQUNIM0QsT0FBTzhCLE9BQVN4RSxPQUs1QjBDLFFBQU82RCxXQUFhLFdBRWhCN0QsT0FBTzFDLEtBQUsrRSxTQUFTM0MsU0FJekJNLFFBQU84RCxjQUFnQixTQUFTdEYsT0FFNUJ3QixPQUFPMUMsS0FBSytFLFNBQVMxQyxPQUFPbkIsTUFBTyxHQUt2Q3dCLFFBQU9nQyxLQUFPLFdBRVY3RSxNQUFNNkYsSUFBSSxzQkFBd0JNLGFBQWFsRixHQUFJNEIsT0FBTzFDLE1BQ3REd0IsUUFBUSxTQUFTeEIsS0FBTUMsT0FBUWQsUUFBU0gsUUFHcENpSCxVQUFVSyxLQUFNLFlBQWN0RyxLQUFLeUcsY0FBZ0IsY0FFdkQvRSxNQUFNLFNBQVMxQixLQUFNQyxPQUFRZCxRQUFTSCxRQUNsQyxHQUFJaUIsUUFBVSxJQUFLLENBQ2Z5QyxPQUFPOEIsU0FBVzZCLGFBQWUsd0VBQzlCLENBQ0gzRCxPQUFPOEIsT0FBU3hFIiwiZmlsZSI6InNyYy9wdWJsaWMvYWRtaW4vanMvbWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEZpcmUgdXAgdGhlIGFwcFxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCduZy1wb3J0Zm9saW8nLCBbJ3VpLnJvdXRlcicsICd1aS5ib290c3RyYXAnLCAnbmdUYWJsZSddKTtcblxuLy8gQ29uZmlndXJlIEFuZ3VsYXJcblxuLyogYXBwLmNvbmZpZyhmdW5jdGlvbigkaW50ZXJwb2xhdGVQcm92aWRlcikge1xuICAgIC8vIFNldCBBbmd1bGFyIHRvIHVzZSBzcXVhcmUtYnJhY2tldHMgaW5zdGVhZCBvZiBjdXJseSAtIGEgd29yayBhcm91bmQgdG8gcGxheSBuaWNlIHdpdGggTGFyYXZlbCBCbGFkZSB0ZW1wbGF0ZXNcbiAgICAkaW50ZXJwb2xhdGVQcm92aWRlci5zdGFydFN5bWJvbCgne3snKTtcbiAgICAkaW50ZXJwb2xhdGVQcm92aWRlci5lbmRTeW1ib2woJ319Jyk7XG59KTsgKi9cblxuYXBwLmNvbmZpZyhmdW5jdGlvbigkaHR0cFByb3ZpZGVyKSB7XG4gICAgLy8gQWRkIHRoZSBYTUxIdHRwUmVxdWVzdCBoZWFkZXIgc28gdGhhdCBMYXJhdmVsIGNhbiB0ZWxsIGFwYXJ0IEFKQVggcmVxdWVzdHNcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXSA9IFwiWE1MSHR0cFJlcXVlc3RcIjtcbn0pO1xuXG5cbi8vIFNldHVwIHRoZSBzdGF0ZSBtYW5hZ2VyIChSb3V0ZXIpXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuICAvLyBGb3IgYW55IHVubWF0Y2hlZCB1cmwsIHJlZGlyZWN0IHRvIC9zdGF0ZTFcbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9kYXNoYm9hcmRcIik7XG5cbiAgLy8kdXJsUm91dGVyUHJvdmlkZXIud2hlbignL3Byb2plY3QnLCAnL3Byb2plY3QvaW5kZXgnKTtcblxuICAvLyBOb3cgc2V0IHVwIHRoZSBzdGF0ZXNcbiAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcbiAgICAgIHVybDogXCIvZGFzaGJvYXJkXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9kYXNoYm9hcmQuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJEYXNoYm9hcmRDb250cm9sbGVyXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgncHJvamVjdCcsIHtcbiAgICAgIHVybDogXCIvcHJvamVjdFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvcHJvamVjdC9wcm9qZWN0Lmh0bWxcIixcbiAgICB9KVxuICAgIC5zdGF0ZSgncHJvamVjdC5pbmRleCcsIHtcbiAgICAgIHVybDogXCIvaW5kZXhcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3Byb2plY3QvcHJvamVjdC5pbmRleC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlByb2plY3RDb250cm9sbGVyXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgncHJvamVjdC5jcmVhdGUnLCB7XG4gICAgICB1cmw6IFwiL2NyZWF0ZVwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3MvcHJvamVjdC9wcm9qZWN0LmVkaXQuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJQcm9qZWN0Q3JlYXRlQ29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2plY3QuZWRpdCcsIHtcbiAgICAgIHVybDogXCIvOmlkL2VkaXRcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcIi92ZW5kb3IvcG9ydGZvbGlvL2FkbWluL3ZpZXdzL3Byb2plY3QvcHJvamVjdC5lZGl0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6IFwiUHJvamVjdEVkaXRDb250cm9sbGVyXCJcbiAgICB9KVxuICAgIC5zdGF0ZSgncHJvamVjdC1zZWN0aW9uJywge1xuICAgICAgdXJsOiBcIi9wcm9qZWN0LzppZC9zZWN0aW9uXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCIvdmVuZG9yL3BvcnRmb2xpby9hZG1pbi92aWV3cy9wcm9qZWN0L3Byb2plY3Quc2VjdGlvbi5pbmRleC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiBcIlByb2plY3RTZWN0aW9uQ29udHJvbGxlclwiXG4gICAgfSlcbiAgICAuc3RhdGUoJ3NlY3Rpb24tZWRpdCcsIHtcbiAgICAgIHVybDogXCIvc2VjdGlvbi86aWQvZWRpdFwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwiL3ZlbmRvci9wb3J0Zm9saW8vYWRtaW4vdmlld3Mvc2VjdGlvbi9zZWN0aW9uLmVkaXQuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogXCJTZWN0aW9uRWRpdENvbnRyb2xsZXJcIlxuICAgIH0pO1xufSk7XG5cblxuLy8gU29tZSBoZWxwZnVsIGZ1bmN0aW9ucyBmb3IgQUpBWCByZXF1ZXN0c1xuYXBwLmZhY3RvcnkoJ1Jlc3RmdWxBcGknLCBmdW5jdGlvbiAoJGh0dHAsIG5vdGlmaWNhdGlvblNlcnZpY2UpIHtcblxuICAgIC8vIFdvdCB0byBkbyBpbmNhc2UgQVBJIGZhaWxzIHRvIHJlc3BvbmQgd2l0aCAyMDBcbiAgICB2YXIgY2hlY2tSZXNwb25zZUNvZGUgPSBmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgc3dpdGNoKHN0YXR1cykge1xuICAgICAgICAgICAgLy8gRmFpbGVkIHZhbGlkYXRpb25cbiAgICAgICAgICAgIGNhc2UgNDIyOlxuXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgYWxsIGV4aXN0aW5nIG5vdGlmaWNhdGlvbnNcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmNsZWFyKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDb25jYXRlbmF0ZSBhbGwgdGhlIHZhbGlkYXRpb24gZXJyb3IgbWVzc2FnZXNcbiAgICAgICAgICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgbXNnID0gbXNnLmNvbmNhdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIG5vdGlmaWNhdGlvblxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiVmFsaWRhdGlvbiBmYWlsZWQsIHBsZWFzZSBjb3JyZWN0IHRoZSBmb2xsb3dpbmcgaXNzdWVzOlwiLCAnZGFuZ2VyJywgbXNnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gVW5hdXRoZW50aWNhdGVkXG4gICAgICAgICAgICBjYXNlIDQwMTpcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZCgnWW91IGhhdmUgYmVlbiBsb2dnZWQgb3V0JywgJ3dhcm5pbmcnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNTAwOlxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKCdBUEkgZXJyb3InLCAnZGFuZ2VyJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU29tZSBvdGhlciBwcm9ibGVtIVwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgLy8gUmV0dXJucyB0aGUgc3RyaW5nIG9mIGEgcGFydGljdWxhciByb3V0ZVxuICAgICAgICBnZXRSb3V0ZTogZnVuY3Rpb24ocmVzb3VyY2UsIG1ldGhvZCwgaWQpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaWQgPT09ICd1bmRlZmluZWQnKSB7IGlkID0gJzAnOyB9XG5cbiAgICAgICAgICAgIHZhciBwcmVmaXggPSAnL2FkbWluL2FwaSc7XG5cbiAgICAgICAgICAgIHZhciByb3V0ZXMgPSB7XG4gICAgICAgICAgICAgICAgcHJvamVjdCAgICAgOiAge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCAgIDogcHJlZml4ICsgJy9wcm9qZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgc2hvdyAgICA6IHByZWZpeCArICcvcHJvamVjdC8nICsgaWQsXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlICAgOiBwcmVmaXggKyAnL3Byb2plY3QnLFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUgIDogcHJlZml4ICsgJy9wcm9qZWN0LycgKyBpZCxcbiAgICAgICAgICAgICAgICAgICAgZGVzdHJveSA6IHByZWZpeCArICcvcHJvamVjdC8nICsgaWRcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNlY3Rpb24gICAgIDogIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggICA6IHByZWZpeCArICcvc2VjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgIHNob3cgICAgOiBwcmVmaXggKyAnL3NlY3Rpb24vJyArIGlkLFxuICAgICAgICAgICAgICAgICAgICBzdG9yZSAgIDogcHJlZml4ICsgJy9zZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlICA6IHByZWZpeCArICcvc2VjdGlvbi8nICsgaWQsXG4gICAgICAgICAgICAgICAgICAgIGRlc3Ryb3kgOiBwcmVmaXggKyAnL3NlY3Rpb24vJyArIGlkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIHJvdXRlc1tyZXNvdXJjZV1bbWV0aG9kXTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIERvIHNvbWUgc3R1ZmYgdXBvbiBhIHN1Y2Nlc3NmdWwgQWpheCByZXF1ZXN0XG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnJlbW92ZUJ5VHlwZSgnZGFuZ2VyJyk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gRG8gc29tZSBzdHVmZiB1cG9uIGFuIHVuc3VjY2Vzc2Z1bCBBamF4IHJlcXVlc3RcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBjaGVja1Jlc3BvbnNlQ29kZShkYXRhLCBzdGF0dXMpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuXG5hcHAuc2VydmljZSgnbm90aWZpY2F0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuXG4gICAgdmFyIG5vdGlmaWNhdGlvbnMgPSBbXTtcblxuICAgIC8vIFJldHJpZXZlIGFsbCBtZXNzYWdlc1xuICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBub3RpZmljYXRpb25zO1xuICAgIH07XG5cbiAgICAvLyBSZW1vdmUgbmV3IG5vdGlmaWNhdGlvblxuICAgIHRoaXMuYWRkID0gZnVuY3Rpb24obWVzc2FnZSwgdHlwZSwgbWVzc2FnZXMpIHtcblxuICAgICAgICAvLyBPbmx5IGFsbG93IG9uZSBzdWNjZXNzIG1lc3NhZ2UgYXQgYSB0aW1lXG4gICAgICAgIGlmICh0eXBlID09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVCeVR5cGUoJ3N1Y2Nlc3MnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBub3RpZmljYXRpb24gPSB7XG4gICAgICAgICAgICB0eXBlIDogdHlwZSxcbiAgICAgICAgICAgIG1lc3NhZ2UgOiBtZXNzYWdlLFxuICAgICAgICAgICAgbWVzc2FnZXMgOiBtZXNzYWdlcyxcbiAgICAgICAgICAgIC8vYWN0aW9uIDogYWN0aW9uXG4gICAgICAgIH07XG5cbiAgICAgICAgbm90aWZpY2F0aW9ucy5wdXNoKG5vdGlmaWNhdGlvbik7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ2FkZGVkICcgKyB0eXBlICsgJyBtZXNzYWdlJyk7XG5cbiAgICAgICAgaWYgKHR5cGUgIT0gJ2RhbmdlcicpIHtcbiAgICAgICAgICAgIC8vIFNldCB0aGUgYWxlcnQgdG8gYmUgcmVtb3ZlZCBhZnRlciBhIGRlbGF5XG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMuc3BsaWNlKG5vdGlmaWNhdGlvbnMuaW5kZXhPZihub3RpZmljYXRpb24pLCAxKTtcbiAgICAgICAgICAgICAgICAvLyRzY29wZS5hbGVydHMuc3BsaWNlKCRzY29wZS5hbGVydHMuaW5kZXhPZihhbGVydCksIDEpO1xuICAgICAgICAgICAgfSwgNjAwMCk7IC8vIG1heWJlICd9LCAzMDAwLCBmYWxzZSk7JyB0byBhdm9pZCBjYWxsaW5nIGFwcGx5XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICAvLyBSZW1vdmUgbm90aWZpY2F0aW9uIGJ5IGFycmF5IGluZGV4XG4gICAgdGhpcy5yZW1vdmVCeUluZGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlbW92aW5nIG9uZSBtZXNzYWdlOiAnICsgaW5kZXgpO1xuICAgICAgICBub3RpZmljYXRpb25zLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGFsbCBub3RpZmljYXRpb25zIG9mIHR5cGVcbiAgICB0aGlzLnJlbW92ZUJ5VHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NsZWFyaW5nICcgKyB0eXBlICsgJyBtZXNzYWdlcycpO1xuICAgICAgICBmb3IgKGk9MDsgaSA8IG5vdGlmaWNhdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChub3RpZmljYXRpb25zW2ldLnR5cGUgPT0gdHlwZSkge1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgYWxsIG5vdGlmaWNhdGlvbnNcbiAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGVhcmluZyBhbGwgbWVzc2FnZXMnKTtcbiAgICAgICAgbm90aWZpY2F0aW9ucyA9IFtdO1xuICAgIH1cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdOb3RpZmljYXRpb25Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCBub3RpZmljYXRpb25TZXJ2aWNlLCAkdGltZW91dCkge1xuXG4gICAgJHNjb3BlLm5vdGlmaWVyID0gbm90aWZpY2F0aW9uU2VydmljZTtcblxuXG4gICAgJHNjb3BlLiR3YXRjaCgnbm90aWZpZXIuZ2V0KCknLCBmdW5jdGlvbiAobm90aWZpY2F0aW9ucykge1xuICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobm90aWZpY2F0aW9ucykpIHtcbiAgICAgICAgICAgICRzY29wZS5ub3RpZmljYXRpb25zID0gbm90aWZpY2F0aW9ucztcbiAgICAgICAgfVxuICAgIH0sIHRydWUpO1xuXG5cbiAgICAkc2NvcGUuY2xvc2VOb3RpZmljYXRpb24gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnJlbW92ZUJ5SW5kZXgoaW5kZXgpO1xuICAgIH07XG5cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdEYXNoYm9hcmRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zKSB7XG5cblxuXG59KTtcblxuYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyLCBuZ1RhYmxlUGFyYW1zLCAkaHR0cCwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSkge1xuXG4gICAgLy8gSW5pdGlhbGlzZSBhbiBlbXB0eSBhcnJheSB0byBob2xkIGRhdGFcbiAgICAkc2NvcGUuZGF0YSA9IFtdO1xuXG4gICAgLy8gSW5pdGlhbGlzZSB0aGUgZGF0YSB0YWJsZVxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBuZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgcGFnZTogMSwgICAgICAgICAgICAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgY291bnQ6IDEwLCAgICAgICAgICAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnZGVzYycgICAgIC8vIGluaXRpYWwgc29ydGluZ1xuICAgICAgICB9LFxuICAgIH0sIHtcbiAgICAgICAgZmlsdGVyRGVsYXk6IDEwLFxuICAgICAgICB0b3RhbDogJHNjb3BlLmRhdGEubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbigkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdXNlIGJ1aWxkLWluIGFuZ3VsYXIgZmlsdGVyXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhID0gcGFyYW1zLmZpbHRlcigpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmRhdGEsIHBhcmFtcy5maWx0ZXIoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTtcbiAgICAgICAgICAgIHZhciBvcmRlcmVkRGF0YSA9IHBhcmFtcy5zb3J0aW5nKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdvcmRlckJ5JykoZmlsdGVyZWREYXRhLCBwYXJhbXMub3JkZXJCeSgpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhO1xuXG4gICAgICAgICAgICBwYXJhbXMudG90YWwob3JkZXJlZERhdGEubGVuZ3RoKTsgLy8gc2V0IHRvdGFsIGZvciByZWNhbGMgcGFnaW5hdGlvblxuICAgICAgICAgICAgJGRlZmVyLnJlc29sdmUob3JkZXJlZERhdGEuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gSW5pdGlhbGlzZSAobG9hZCkgZGF0YVxuICAgICRzY29wZS5pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZyhSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3VwZGF0ZScsIDQpKTtcblxuICAgICAgICAkaHR0cC5nZXQoUmVzdGZ1bEFwaS5nZXRSb3V0ZSgncHJvamVjdCcsICdpbmRleCcpKS5cbiAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy5yZWxvYWQoKTtcbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuZGVsZXRlID0gZnVuY3Rpb24oaWQsIHRpdGxlKSB7XG5cbiAgICAgICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2lzaCB0byBkZWxldGUgJyArIHRpdGxlICsgJz8nKSkge1xuXG4gICAgICAgICAgICAkaHR0cC5kZWxldGUoJy9hZG1pbi9hcGkvcHJvamVjdC8nICsgaWQpLlxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJQcm9qZWN0ICdcIiArIGRhdGEudGl0bGUgKyBcIicgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIiwgJ2luZm8nKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmluaXQoKTtcbiAgICAgICAgICAgICAgICB9KS5cbiAgICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuaW5pdCgpO1xuXG5cbn0pO1xuXG5cblxuYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RDcmVhdGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsIFJlc3RmdWxBcGksIG5vdGlmaWNhdGlvblNlcnZpY2UpIHtcblxuICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKGFwcGx5KSB7XG5cbiAgICAgICAgJGh0dHAucG9zdChSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3N0b3JlJyksICRzY29wZS5kYXRhKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiUHJvamVjdCAnXCIgKyBkYXRhLnRpdGxlICsgXCInIGFkZGVkIHN1Y2Nlc3NmdWxseVwiLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoIWFwcGx5KSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbyggXCJwcm9qZWN0LmluZGV4XCIgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInByb2plY3QuZWRpdFwiLCB7aWQ6IGRhdGEuaWR9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5lcnJvcihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdQcm9qZWN0RWRpdENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgUmVzdGZ1bEFwaSwgbm90aWZpY2F0aW9uU2VydmljZSwgbmdUYWJsZVBhcmFtcywgJGZpbHRlciwgJG1vZGFsKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IHtcbiAgICAgICAgc2VjdGlvbnMgOiBbXVxuICAgIH07XG5cblxuICAgICRzY29wZS50YWJsZVBhcmFtcyA9IG5ldyBuZ1RhYmxlUGFyYW1zKHtcbiAgICAgICAgcGFnZTogMSwgICAgICAgICAgICAvLyBzaG93IGZpcnN0IHBhZ2VcbiAgICAgICAgY291bnQ6IDEwLCAgICAgICAgICAvLyBjb3VudCBwZXIgcGFnZVxuICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICB1cGRhdGVkX2F0OiAnZGVzYycgICAgIC8vIGluaXRpYWwgc29ydGluZ1xuICAgICAgICB9LFxuICAgIH0sIHtcbiAgICAgICAgZmlsdGVyRGVsYXk6IDEwLFxuICAgICAgICB0b3RhbDogJHNjb3BlLmRhdGEuc2VjdGlvbnMubGVuZ3RoLCAvLyBsZW5ndGggb2YgZGF0YVxuICAgICAgICBnZXREYXRhOiBmdW5jdGlvbigkZGVmZXIsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdXNlIGJ1aWxkLWluIGFuZ3VsYXIgZmlsdGVyXG4gICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhID0gcGFyYW1zLmZpbHRlcigpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmRhdGEuc2VjdGlvbnMsIHBhcmFtcy5maWx0ZXIoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9ucztcbiAgICAgICAgICAgIHZhciBvcmRlcmVkRGF0YSA9IHBhcmFtcy5zb3J0aW5nKCkgP1xuICAgICAgICAgICAgICAgICAgICAkZmlsdGVyKCdvcmRlckJ5JykoZmlsdGVyZWREYXRhLCBwYXJhbXMub3JkZXJCeSgpKSA6XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnNlY3Rpb25zO1xuXG4gICAgICAgICAgICBwYXJhbXMudG90YWwob3JkZXJlZERhdGEubGVuZ3RoKTsgLy8gc2V0IHRvdGFsIGZvciByZWNhbGMgcGFnaW5hdGlvblxuICAgICAgICAgICAgJGRlZmVyLnJlc29sdmUob3JkZXJlZERhdGEuc2xpY2UoKHBhcmFtcy5wYWdlKCkgLSAxKSAqIHBhcmFtcy5jb3VudCgpLCBwYXJhbXMucGFnZSgpICogcGFyYW1zLmNvdW50KCkpKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cblxuXG4gICAgJGh0dHAuZ2V0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3Byb2plY3QnLCAnc2hvdycsICRzdGF0ZVBhcmFtcy5pZCkpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgJHNjb3BlLnNsdWcgPSAkc2NvcGUuZGF0YS5zbHVnO1xuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuICAgICAgICB9KS5cbiAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IGRhdGE7XG4gICAgICAgIH0pO1xuXG5cbi8qXG4gICAgJHNjb3BlLmFkZFNlY3Rpb24gPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAkc2NvcGUuZGF0YS5zZWN0aW9ucy5wdXNoKHt9KTtcblxuICAgIH07XG5cbiAgICAkc2NvcGUuZGVsZXRlU2VjdGlvbiA9IGZ1bmN0aW9uKGluZGV4KSB7XG5cbiAgICAgICAgJHNjb3BlLmRhdGEuc2VjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgIH07XG4qL1xuXG5cbiRzY29wZS5lZGl0U2VjdGlvbiA9IGZ1bmN0aW9uIChzZWN0aW9uSW5kZXgpIHtcblxuICAgIHZhciBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3NlY3Rpb25FZGl0Lmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ2VkaXRTZWN0aW9uQ29udHJvbGxlcicsXG4gICAgICBzaXplOiAnbWQnLFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgICBzZWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICRzY29wZS5kYXRhLnNlY3Rpb25zW3NlY3Rpb25JbmRleF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuLypcbiAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgfSk7XG4qL1xuICB9O1xuXG4gICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgfTtcblxuXG5cblxuICAgICRzY29wZS5zbHVnV2FybmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLnJlbW92ZUJ5VHlwZSgnd2FybmluZycpO1xuICAgICAgICBpZiAoJHNjb3BlLnNsdWcgIT0gJHNjb3BlLmRhdGEuc2x1Zykge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5hZGQoXCJZb3UgaGF2ZSBtb2RpZmllZCB0aGUgcHJvamVjdCBzbHVnLiBQbGVhc2UgYmUgYXdhcmUgdGhhdCB0aGlzIG1heSBicmVhayBoeXBlcmxpbmtzIHRvIHRoaXMgcHJvamVjdC5cIiwgJ3dhcm5pbmcnKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihhcHBseSkge1xuICAgICAgICBhcHBseSA9IHR5cGVvZiBhcHBseSAhPT0gJ3VuZGVmaW5lZCcgPyBhcHBseSA6IGZhbHNlO1xuXG4gICAgICAgIGlmICgkc2NvcGUuc2x1ZyAhPSAkc2NvcGUuZGF0YS5zbHVnKSB7XG4gICAgICAgICAgICBpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3aXNoIHRvIGNoYW5nZSB0aGUgc2x1Zz8nKSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wdXQoYXBwbHkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5zbHVnID0gJHNjb3BlLnNsdWc7XG4gICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU2VydmljZS5yZW1vdmVCeVR5cGUoJ3dhcm5pbmcnKTtcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIlNsdWcgcmVzZXRcIiwgJ2luZm8nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzY29wZS5wdXQoYXBwbHkpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAkc2NvcGUucHV0ID0gZnVuY3Rpb24oYXBwbHkpIHtcbiAgICAgICAgICAgICRodHRwLnB1dChSZXN0ZnVsQXBpLmdldFJvdXRlKCdwcm9qZWN0JywgJ3VwZGF0ZScsICRzdGF0ZVBhcmFtcy5pZCksICRzY29wZS5kYXRhKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLnN1Y2Nlc3MoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UuYWRkKFwiUHJvamVjdCAnXCIgKyBkYXRhLnRpdGxlICsgXCInIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmICghYXBwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCBcInByb2plY3QuaW5kZXhcIiApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZnVsQXBpLmVycm9yKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuXG59KTtcblxuXG5cblxuXG5hcHAuY29udHJvbGxlcignZWRpdFNlY3Rpb25Db250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRtb2RhbEluc3RhbmNlLCBSZXN0ZnVsQXBpLCBub3RpZmljYXRpb25TZXJ2aWNlLCBzZWN0aW9uKSB7XG5cbiAgICAkc2NvcGUuc2VjdGlvbiA9IHNlY3Rpb247XG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKGFwcGx5KSB7XG5cbiAgICAgICAgJGh0dHAucHV0KFJlc3RmdWxBcGkuZ2V0Um91dGUoJ3NlY3Rpb24nLCAndXBkYXRlJywgJHNjb3BlLnNlY3Rpb24uaWQpLCAkc2NvcGUuc2VjdGlvbilcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgUmVzdGZ1bEFwaS5zdWNjZXNzKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb25TZXJ2aWNlLmFkZChcIlNlY3Rpb24gJ1wiICsgZGF0YS50aXRsZSArIFwiJyB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoIWFwcGx5KSB7XG4gICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIFJlc3RmdWxBcGkuZXJyb3IoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG5cbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgfTtcbn0pO1xuXG5hcHAuY29udHJvbGxlcignUHJvamVjdFNlY3Rpb25Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZmlsdGVyLCBuZ1RhYmxlUGFyYW1zLCAkaHR0cCwgJHJvdXRlLCAkcm91dGVQYXJhbXMsICRsb2NhdGlvbikge1xuXG4gICAgJHNjb3BlLmRhdGEgPSBbXTtcblxuICAgIC8vIEluaXRpYWxpc2UgdGhlIGRhdGEgdGFibGVcbiAgICAkc2NvcGUudGFibGVQYXJhbXMgPSBuZXcgbmdUYWJsZVBhcmFtcyh7XG4gICAgICAgIHBhZ2U6IDEsICAgICAgICAgICAgLy8gc2hvdyBmaXJzdCBwYWdlXG4gICAgICAgIGNvdW50OiAxMCwgICAgICAgICAgLy8gY291bnQgcGVyIHBhZ2VcbiAgICAgICAgc29ydGluZzoge1xuICAgICAgICAgICAgY3JlYXRlZF9hdDogJ2Rlc2MnICAgICAvLyBpbml0aWFsIHNvcnRpbmdcbiAgICAgICAgfSxcbiAgICB9LCB7XG4gICAgICAgIGZpbHRlckRlbGF5OiAxMCxcbiAgICAgICAgdG90YWw6ICRzY29wZS5kYXRhLmxlbmd0aCwgLy8gbGVuZ3RoIG9mIGRhdGFcbiAgICAgICAgZ2V0RGF0YTogZnVuY3Rpb24oJGRlZmVyLCBwYXJhbXMpIHtcbiAgICAgICAgICAgIC8vIHVzZSBidWlsZC1pbiBhbmd1bGFyIGZpbHRlclxuICAgICAgICAgICAgdmFyIGZpbHRlcmVkRGF0YSA9IHBhcmFtcy5maWx0ZXIoKSA/XG4gICAgICAgICAgICAgICAgICAgICRmaWx0ZXIoJ2ZpbHRlcicpKCRzY29wZS5kYXRhLCBwYXJhbXMuZmlsdGVyKCkpIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE7XG4gICAgICAgICAgICB2YXIgb3JkZXJlZERhdGEgPSBwYXJhbXMuc29ydGluZygpID9cbiAgICAgICAgICAgICAgICAgICAgJGZpbHRlcignb3JkZXJCeScpKGZpbHRlcmVkRGF0YSwgcGFyYW1zLm9yZGVyQnkoKSkgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YTtcblxuICAgICAgICAgICAgcGFyYW1zLnRvdGFsKG9yZGVyZWREYXRhLmxlbmd0aCk7IC8vIHNldCB0b3RhbCBmb3IgcmVjYWxjIHBhZ2luYXRpb25cbiAgICAgICAgICAgICRkZWZlci5yZXNvbHZlKG9yZGVyZWREYXRhLnNsaWNlKChwYXJhbXMucGFnZSgpIC0gMSkgKiBwYXJhbXMuY291bnQoKSwgcGFyYW1zLnBhZ2UoKSAqIHBhcmFtcy5jb3VudCgpKSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgICRzY29wZS5pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJHJvdXRlUGFyYW1zLnByb2plY3RfaWQpO1xuXG4gICAgICAgICRodHRwLmdldCgnL2FkbWluL2FwaS9wcm9qZWN0LycgKyAkcm91dGVQYXJhbXMucHJvamVjdF9pZCArICcvc2VjdGlvbicpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG5cbiAgICAgICAgICAgIC8vIFBhcnNlIElEIGZyb20gdGV4dCB0byBpbnRlZ2VyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBkYXRhLmlkICA9IHBhcnNlRmxvYXQoZGF0YS5pZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnJlbG9hZCgpO1xuXG4gICAgICAgIH0pLlxuICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3RhdHVzKTtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9ycyA9IFt7XCJMb2dnZWQgb3V0XCIgOiBcIllvdSBoYXZlIGJlZW4gbG9nZ2VkIG91dC4gUmVmcmVzaCB0aGUgcGFnZSB0byBsb2cgYmFjayBpbiBhZ2FpblwifV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgfTtcblxuXG4gICAgJHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uKGlkKSB7XG5cbiAgICAgICAgJGh0dHAuZGVsZXRlKCcvYWRtaW4vYXBpL3Byb2plY3QvJyArIGlkKS5cbiAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmluaXQoKTtcbiAgICAgICAgICB9KS5cbiAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS5pbml0KCk7XG5cbn0pO1xuXG5cblxuYXBwLmNvbnRyb2xsZXIoJ1NlY3Rpb25DcmVhdGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHJvdXRlLCAkcm91dGVQYXJhbXMsICRsb2NhdGlvbikge1xuXG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcblxuICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FkbWluL2FwaS9wcm9qZWN0JywgJHNjb3BlLmRhdGEpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCBcIi9wcm9qZWN0XCIgKTtcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09IDQwMSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gW3tcIkxvZ2dlZCBvdXRcIiA6IFwiWW91IGhhdmUgYmVlbiBsb2dnZWQgb3V0LiBSZWZyZXNoIHRoZSBwYWdlIHRvIGxvZyBiYWNrIGluIGFnYWluXCJ9XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdTZWN0aW9uRWRpdENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkcm91dGUsICRyb3V0ZVBhcmFtcywgJGxvY2F0aW9uKSB7XG5cbiAgICAkc2NvcGUuZGF0YSA9IHt9O1xuXG4gICAgJGh0dHAuZ2V0KCcvYWRtaW4vYXBpL3NlY3Rpb24vJyArICRyb3V0ZVBhcmFtcy5pZCkuXG4gICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcbiAgICAgICAgfSkuXG4gICAgICAgIGVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzID09IDQwMSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbe1wiTG9nZ2VkIG91dFwiIDogXCJZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQuIFJlZnJlc2ggdGhlIHBhZ2UgdG8gbG9nIGJhY2sgaW4gYWdhaW5cIn1dO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3JzID0gZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICRzY29wZS5hZGRTZWN0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJHNjb3BlLmRhdGEuc2VjdGlvbnMucHVzaCh7fSk7XG5cbiAgICB9O1xuXG4gICAgJHNjb3BlLmRlbGV0ZVNlY3Rpb24gPSBmdW5jdGlvbihpbmRleCkge1xuXG4gICAgICAgICRzY29wZS5kYXRhLnNlY3Rpb25zLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICRodHRwLnB1dCgnL2FkbWluL2FwaS9zZWN0aW9uLycgKyAkcm91dGVQYXJhbXMuaWQsICRzY29wZS5kYXRhKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcblxuXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoIFwiL3Byb2plY3QvXCIgKyBkYXRhLmF0dGFjaG1lbnRfaWQgKyBcIi9zZWN0aW9uXCIpO1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBlcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBbe1wiTG9nZ2VkIG91dFwiIDogXCJZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQuIFJlZnJlc2ggdGhlIHBhZ2UgdG8gbG9nIGJhY2sgaW4gYWdhaW5cIn1dO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5lcnJvcnMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=